<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>مركز بحوث الصحراء</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts for Arabic text -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
      /* Desert Research Center Palette */
      :root{
        /* من اللوجو */
        --drc-green:#0a8f3a;   /* الأخضر السفلي */
        --drc-green-2:#0f7a32;
        --drc-yellow:#f1d335;  /* الأصفر الصحراوي */
        --drc-yellow-2:#f7e27a;
        --drc-blue:#1463b0;    /* الأزرق النيلي */
        --drc-blue-2:#0b4f8f;
        --drc-red:#d52b1e;     /* علم مصر */
        --drc-black:#101213;
        --drc-white:#ffffff;

        /* نظام الألوان للتطبيق */
        --ink:#1e293b;
        --paper:#f6f7f9;
        --soft:#e2e8f0;
        --ring:#a7e9b8;

        /* لون التليجرام الجديد */
        --drc-telegram-blue: #0088cc;
      }

      /* MODIFIED: New subtle background for a more professional feel */
      body{
        font-family:'Cairo',sans-serif;
        background-color: var(--paper);
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><g fill="%23e2e8f0" fill-opacity="0.2"><rect x="50" width="50" height="50"/><rect y="50" width="50" height="50"/></g></svg>');
        color:var(--ink);
        transition:background-color .3s ease,color .3s ease;
      }

      html,body,#root{ background-color:transparent!important; color:var(--ink)!important; }

      /* Ensure no dark mode classes interfere */
      .dark\:*, .dark:not(.force-dark){
        --tw-bg-opacity:1!important; background-color:var(--paper)!important;
        --tw-text-opacity:1!important; color:var(--ink)!important;
        --tw-border-opacity:1!important; border-color:var(--soft)!important;
        box-shadow:none!important;
      }

      /* إعادة تعيين درجات Tailwind الخضراء للّوجو */
      .bg-green-700{ background-color:var(--drc-green-2)!important; }
      .bg-green-800{ background-color:#0c5f2a!important; }
      .bg-green-600{ background-color:var(--drc-green)!important; }
      .bg-green-200{ background-color:#c8efc8!important; }
      .bg-green-100{ background-color:#e8f7e8!important; }
      .bg-green-50 { background-color:#f4fbf5!important; }
      .text-green-800{ color:#0c5f2a!important; }
      .text-green-700{ color:var(--drc-green-2)!important; }
      .text-green-200{ color:#c8efc8!important; }
      .placeholder\:text-slate-400{ color:#64748b!important; }

      /* بطاقات */
      .lemon-card{
        background:var(--drc-white);
        border:1px solid var(--soft);
        border-radius:1.25rem;
        box-shadow:0 10px 25px rgba(16,79,143,.06); /* ظل يميل للأزرق النيلي */
      }

      /* شريط علوي: علم مصر + ترويسة خضراء */
      .lemon-header{ background:linear-gradient(135deg, var(--drc-green), var(--drc-green-2)); border-bottom:4px solid var(--drc-green-2); }

      /* زر أساسي (أخضر→أزرق) */
      .btn-primary{
        background:linear-gradient(135deg, var(--drc-green), var(--drc-blue));
        color:#fff; border-radius:.875rem;
        box-shadow:0 8px 20px rgba(20,99,176,.20);
        transition:transform .15s ease, box-shadow .2s ease, filter .2s ease;
      }
      .btn-primary:hover{ transform:translateY(-1px); filter:saturate(1.05); }
      .btn-primary:active{ transform:translateY(0); box-shadow:0 6px 16px rgba(20,99,176,.18); }

      /* فقاعات المحادثة */
      .bubble-user{
        background:linear-gradient(135deg, var(--drc-green), var(--drc-blue));
        color:#fff; border-radius:1.25rem 1.25rem .5rem 1.25rem;
        box-shadow:0 8px 18px rgba(20,99,176,.15);
      }
      .bubble-bot{
        background:#fffef6; /* مائل للأصفر الصحراوي الفاتح */
        border:1px solid var(--soft);
        color:var(--ink);
        border-radius:1.25rem 1.25rem 1.25rem .5rem;
        box-shadow:0 8px 18px rgba(241,211,53,.09);
      }

      /* إدخال */
      .input-shell{
        background:#f8fafc; border:1px solid var(--soft); border-radius:1.25rem;
        box-shadow:inset 0 3px 10px rgba(2,6,23,.03);
      }
      .input-shell:has(:focus){ outline:3px solid var(--ring); outline-offset:0; }

      /* Chips للأسئلة المقترحة (أصفر + إطار أخضر) */
      .chip{
        background:var(--drc-yellow-2); color:#2b2b2b;
        border:1px solid var(--drc-green-2);
        border-radius:.875rem; box-shadow:0 4px 10px rgba(241,211,53,.12);
        transition:transform .12s ease, background .2s ease, box-shadow .2s ease;
      }
      .chip:hover{ background:var(--drc-yellow); transform:translateY(-1px); }

      /* خلفية ديكورية (دوائر صفراء + بقعة خضراء/زرقاء خفيفة) */
      /* MODIFIED: Made the decor much more subtle */
      .lemon-decor{
        position:absolute; inset:0; pointer-events:none; z-index:-1; opacity:.1;
        background:
          url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="900" height="900" viewBox="0 0 900 900"><circle cx="760" cy="120" r="110" fill="%23f1d335" fill-opacity=".22"/><circle cx="140" cy="280" r="80" fill="%23f7e27a" fill-opacity=".24"/><circle cx="820" cy="560" r="70" fill="%231463b0" fill-opacity=".16"/></svg>') no-repeat right -100px top -40px / 700px,
          radial-gradient(500px 220px at 15% 8%, #fffbe6, transparent 60%);
      }

      /* الرسوم المتحركة القائمة لديك (كما هي) */
      .chat-message:last-child{ animation:chat-message-appear .3s ease-in-out; }
      @keyframes chat-message-appear{ from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }
      .experience-animation-text{ animation:subtle-pulse 2s infinite ease-in-out; }
      @keyframes subtle-pulse{ 0%,100%{opacity:.7} 50%{opacity:1} }
      
      /* ألوان زر التليجرام */
      .btn-telegram {
        background-color: var(--drc-telegram-blue);
        color: #fff;
        border-radius:.875rem;
        box-shadow:0 8px 20px rgba(0, 136, 204,.20);
        transition:transform .15s ease, box-shadow .2s ease, filter .2s ease;
      }
      .btn-telegram:hover {
        background-color: #007bb6;
        transform:translateY(-1px); filter:saturate(1.05);
      }
      .btn-telegram:active{ transform:translateY(0); box-shadow:0 6px 16px rgba(0, 136, 204,.18); }

      /* Small Telegram Button specific styles */
      .btn-telegram-small {
        padding: 0.6rem 1.25rem;
        font-size: 0.875rem;
        border-radius: 0.75rem;
      }
    </style>
    <!-- Babel Standalone for client-side JSX and modern JS compilation -->
    <script src="https://unpkg.com/@babel/standalone@7/babel.min.js"></script>
    <!-- Import Map to resolve modules from ESM.sh -->
    <script type="importmap">
{
  "imports": {
    "@google/genai": "https://esm.sh/@google/genai@^1.11.0",
    "react-dom/client": "https://esm.sh/react-dom@^19.1.1/client",
    "react-dom": "https://esm.sh/react-dom@^19.1.1",
    "react": "https://esm.sh/react@^19.1.1",
    "react/": "https://esm.sh/react@^19.1.1/",
    "react-dom/": "https://esm.sh/react-dom@^19.1.1/"
  }
}
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- Consolidated React Application Code -->
    <script type="text/babel" data-type="module">
// --- Start of consolidated application code ---

import React, { useState, useEffect, useRef, useCallback } from 'react';
import ReactDOM from 'react-dom/client';
import { GoogleGenAI, Type } from "@google/genai";

// --- GLOBAL CONFIGURATION ---
const GEMINI_API_KEY = "AIzaSyDXWhb2-ZhmCA2JXZp2xGkrWITrHGYf1NA"; 
const WHATSAPP_GROUP_URL = "https://chat.whatsapp.com/BGl2OMOcECM17f13lm0UaR?mode=ac_t";
const TELEGRAM_BOT_URL = "https://t.me/Mohamedrashed87bot";


// --- From types.ts ---
const Sender = {
  User: 'user',
  Bot: 'bot',
};


// --- From components/IconComponents.tsx ---
const SendIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" viewBox="0 0 24 24" fill="currentColor">
    <path d="M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z" />
  </svg>
);

const BotIcon = () => (
    <svg xmlns="http://www.w3.org/2000/svg" className="h-full w-full" viewBox="0 0 24 24" fill="#f1d335">
      <path d="M16 12c0 2.21-1.79 4-4 4s-4-1.79-4-4 1.79-4 4-4 4 1.79 4 4zm-4 6c-2.05 0-3.89-.63-5.3-1.68l-2.12 2.12C5.39 19.98 8.5 22 12 22s6.61-2.02 9.42-5.56l-2.12-2.12C15.89 17.37 14.05 18 12 18zM12 2C8.5 2 5.39 4.02 2.58 7.56l2.12 2.12C7.95 6.63 9.79 6 12 6s4.05.63 5.42 2.37l2.12-2.12C18.61 4.02 15.5 2 12 2z"/>
    </svg>
);

const UserIcon = () => (
    <svg xmlns="http://www.w3.org/2000/svg" className="h-full w-full" viewBox="0 0 24 24" fill="#ffffff">
        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
    </svg>
);

const NewChatIcon = () => (
    <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
        <path strokeLinecap="round" strokeLinejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
        <path strokeLinecap="round" strokeLinejoin="round" d="M12 8v4m0 0v4m0-4h4m-4 0H8" />
    </svg>
);

const WhatsAppIcon = ({ className }) => (
  <svg xmlns="http://www.w3.org/2000/svg" className={className} width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
    <path d="M12.04 2c-5.45 0-9.91 4.46-9.91 9.91 0 1.75.5 3.42 1.46 4.88l-1.53 5.61 5.72-1.5L12.04 22c5.45 0 9.91-4.46 9.91-9.91S17.49 2 12.04 2zm3.62 14.38s-.24-.36-.36-.59c-.12-.23-.62-.48-.86-.6-.24-.12-.55-.02-.75.31-.2.33-.49.59-.62.71-.12.12-.25.22-.49.31-.24.09-.59.19-.94.06-.36-.12-.86-.31-1.63-1-.6-.52-1-1.12-1.25-1.53-.25-.4-.03-.64.12-.79.1-.1.22-.22.31-.31.09-.09.12-.2.18-.31.06-.12.03-.22-.09-.49-.12-.27-.75-1.81-.99-2.43-.24-.62-.48-.52-.6-.54-.12-.03-.25-.03-.49-.03-.24 0-.62.09-.86.31-.24.22-.94.9-.94 2.18 0 1.28.97 2.52 1.1 2.77.12.24 1.94 2.97 4.67 4.12 2.73 1.14 2.73.76 3.23.71.5-.06 1.46-.62 1.68-1.25.22-.62.22-.9.15-1.09-.09-.2-.25-.31-.5-.43z"/>
  </svg>
);

const TelegramIcon = ({ className }) => (
  <svg xmlns="http://www.w3.org/2000/svg" className={className} viewBox="0 0 24 24" fill="currentColor">
    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.3 7.21l-7.23 5.48c-.22.17-.49.26-.77.26-.38 0-.7-.14-.95-.36-.45-.4-.53-1.09-.18-1.54l1.83-2.26c.14-.17.18-.4.1-.63l-.4-.44-2.14-1.28c-.28-.17-.46-.49-.46-.83V8.04c0-.4.32-.72.72-.72h4.51c.31 0 .58.21.68.52l1.63 4.96c.09.28.02.58-.17.8z"/>
  </svg>
);

const InfoIcon = ({ className }) => (
  <svg xmlns="http://www.w3.org/2000/svg" className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
    <path strokeLinecap="round" strokeLinejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
  </svg>
);

// NEW: Copy Icon
const CopyIcon = ({ className }) => (
  <svg xmlns="http://www.w3.org/2000/svg" className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
    <path strokeLinecap="round" strokeLinejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
  </svg>
);


// --- From components/Logo.tsx ---
const DesertResearchCenterLogo = ({ className = "w-full h-full object-contain" }) => (
    <img src="1.png" alt="شعار مركز بحوث الصحراء" className={className} />
);

const ChatHeaderLogo = () => (
    <img src="logo.png" alt="شعار المبادرة" className="w-8 h-8 object-contain" />
);

// --- From services/geminiService.ts ---
const ai = GEMINI_API_KEY ? new GoogleGenAI({ apiKey: GEMINI_API_KEY }) : null;

// [CONTEXT DATA - Truncated for brevity. The full context data from the previous step goes here]
// ...
// All context strings (agricultureContext, datePalmContext, etc.) are included here as before.
// ...
const agricultureContext = `
أولاً: ممارسات الزراعة العامة ومحاصيل متنوعة

السؤال: ما هي التوصية العامة لزراعة المحاصيل بجوار الزيتون لضمان الجدوى الاقتصادية وعدم التشتت؟
الجواب: يُنصح بتوحيد زراعة المحاصيل بجوار الزيتون.

السؤال: ما هي المحاصيل المقترحة للزراعة بشكل عام؟
الجواب: البطيخ (للأكل)، السمسم، اللوبيا، البقل. الطماطم الصيفي مكلفة في برنامج المكافحة.

السؤال: هل يتم زراعة شتلات البطيخ أو السمسم أو اللوبيا أم بذورها؟
الجواب: تزرع بالبذور مباشرة.

السؤال: ما هو الغرض من "التحميل" (زراعة محصولين معًا)؟
الجواب: (لم يذكر الغرض بشكل واضح في النصوص).

السؤال: هل يمكن زراعة المانجو والموالح في مناطق مثل النثيلة أو طيبة التمد؟
الجواب: لا ينصح بذلك في النثيلة بسبب التربة الجيرية وملوحة مياه الري. ولا يجوز في طيبة التمد.

السؤال: ما هي المدة الزمنية لبدء التسميد بعد زراعة الزيتون؟
الجواب: يجب الانتظار حتى خروج نموات حديثة.

السؤال: ما هو الوقت المناسب لزراعة الزيتون؟
الجواب: يمكن الزراعة حاليًا أو خلال شهر قادم (وقت المحادثة).

السؤال: ما هي أفضل طريقة لزراعة الزيتون (مسافات وعدد صفوف الملقح)؟
الجواب: يفضل زراعة 3 صفوف من الصنف الرئيسي (مثل البيكوال) يليه صف واحد من صنف ملقح (مثل المانزانيللو)، ويكون الداير (الصف الخارجي) كروناكي.

السؤال: هل الشملالي صنف زيتون مناسب لمنطقة النهايات؟
الجواب: نعم.

السؤال: هل الرمان يجود للزراعة في سهل القاع؟
الجواب: لا يجود، بسبب ملوحة مياه الري العالية (4000 جزء في المليون) وملوحة التربة.

السؤال: هل الأرز البسمتي بمياه مالحة مناسب للزراعة في الصحراء؟
الجواب: لم يتم التأكيد على جدواه الاقتصادية (يتطلب التجربة).

السؤال: هل السمسم مناسب للزراعة في خشم الجاد؟
الجواب: لا، بسبب الملوحة العالية.

السؤال: هل الخوخ والمشمش مناسبان للزراعة في أسلا وعريق؟
الجواب: نعم، يصلحان. (الأنواع الموصى بها: الخوخ فلوريدا أو سويلنج على أصل نيماجارد، والمشمش كانينو).

السؤال: ما هو أقصى موعد لزراعة اللوبيا؟
الجواب: 15 مايو. (الأصناف الموصى بها: لوبيا كفر الشيخ أو كريم 7).

السؤال: هل يمكن زراعة اللوبيا أو السمسم في جور الزيتون؟
الجواب: لا يجوز زراعتها في جور الزيتون، خاصة إذا كانت الزيتون مزروعة حديثاً، لأن اللوبيا ستحتاج إلى اقتلاع مما سيضر بالزيتون.

السؤال: ما هي مواعيد زراعة الكركديه؟
الجواب: منتصف أبريل إلى أول مايو.

السؤال: هل زراعة الذرة الشامية حول جور الزيتون تسبب أضرارًا؟
الجواب: نعم، تسبب أضرارًا كبيرة للزيتون.

السؤال: هل زراعة الذرة الشامية تجود في الحمة؟
الجواب: لا ينصح بذلك، وتحتاج الذرة إلى أزوت عالي ومادة عضوية بكميات كبيرة، وهذا لا يتوفر في هذا التجمع.

السؤال: هل نبات الاستيفيا يجود في الدفيدف؟ وما هي أقصى ملوحة يتحملها؟
الجواب: لا يجود، لأنه حساس جدًا للملوحة (أقصى حد 700 جزء في المليون).

السؤال: هل يمكن زراعة التين الشوكي مع الزيتون في نفس الأرض؟
الجواب: (لم يتم الرد بشكل مباشر).

السؤال: ما هي أضرار زراعة البزروميا (كينو كاربس)?
الجواب: تستهلك كميات كبيرة من المياه، ولا تعطي خشبًا جيدًا.

السؤال: هل يمكن زراعة النبق المطعوم والزيتون معًا في قطعة واحدة بتجمع الخفجة؟
الجواب: نعم، يمكن زراعتهما معًا، ولكن يجب أن تكون الزراعة "هذا لوحده وده لوحده" (أي منفصلة بمسافة 5x5 متر).

السؤال: هل زراعة الفول الصويا تجود كزراعة صيفية في تجمع النهايات؟
الجواب: نعم تصلح.

السؤال: هل زراعة البرسيم الحجازي حول شجرة الزيتون يساعد على تقليل الأملاح وتحسين التربة؟
الجواب: لا ينصح بذلك، يجب ترك شجرة الزيتون في حالها.

السؤال: هل يمكن زراعة العنب والفراولة في وادي سعال؟
الجواب: العنب يجود بجميع أصنافه. الفراولة لا تجود.

السؤال: هل الرمان يجود في أبو رصاصة؟
الجواب: لا يجود، بسبب ملوحة مياه الري العالية.

السؤال: ما هي طريقة الري الموصى بها لأشجار الزيتون؟
الجواب: 8 لتر/شتلة/يوم أو 16 لتر يوم بعد يوم.

السؤال: هل زراعة لب البطيخ السوبر مع الزيتون تسبب مشكلة؟
الجواب: تسبب مشكلة للزيتون، يجب إبعادها عن جور الزيتون.

السؤال: ما هو أفضل نوع لب للزراعة؟
الجواب: لب البطيخ، السوبر، أو لب الجورمه.

السؤال: ما هي أقصى فترة يمكن أن تبقى فيها الشتلات في الأكياس قبل الزراعة؟
الجواب: (لم يذكر فترة محددة، ولكن تم الإشارة إلى إمكانية بقائها بانتظام الري).

السؤال: ما هي أنواع نخيل البلح المناسبة للزراعة؟
الجواب: الحياني، عمري، عجلاني، بنت عيشة. (البَرِحي والمجدول صالحان للزراعة في النثيلة).

السؤال: ما هي أنواع النخل التي تصلح للزراعة في ك61 بغداد؟
الجواب: الحياني، العمري، العجلاني، بنت عيشة، برحي، مجدول.

السؤال: ما هي المحاصيل الصيفية التي تتحمل الملوحة في الحمة؟
الجواب: السمسم، اللوبيا، عباد الشمس، البقول، الخضراوات (باذنجان، فلفل، طماطم، بنجر أحمر، كرنب أحمر).

السؤال: ما هي المحاصيل الصيفية التي يمكن زراعتها في طويل الحامض؟
الجواب: اللوبيا، دوار الشمس، لب كوسة، قرع، بطيخ، سمسم.

السؤال: ما هي أفضل نباتات للزراعة في الصحراء كمحاصيل طبية وعطرية وتتحمل الصقيع؟
الجواب: الأورجانو التركي، المريمية (يفضل الألمانية)، الزعتر الحقيقي (البري)، والروزماري.

السؤال: ما هي نصيحة التعامل مع شتلات اللوز الحلو بعد 15 يومًا من الزراعة؟
الجواب: يجب الحرص في التعامل معها، خاصة إذا كانت الزراعة تمت بدون عملية "كمر" وأن النقل تم في صفيحة، ويفضل استشارة خبير.

السؤال: ما هي أقصى درجة ملوحة يمكن أن يتحملها التين الشوكي؟
الجواب: 3000 جزء في المليون.

السؤال: ما هي شروط زراعة التين الشوكي ليكون ناجحًا؟
الجواب: يجب أن تكون الأرض رملية جيدة الصرف (ويفضل تجربتها في أكتوبر ونوفمبر).

السؤال: ما هو التعامل مع التين الشوكي الذي عمره سنة؟
الجواب: يجب تسقيط الثمار (تقليمها)، والاكتفاء بثمرة واحدة، والري كل 5 أيام في الصيف.

السؤال: ما هي أقصى درجة ملوحة يمكن أن يتحملها شجر الخوخ لإنتاج جيد؟
الجواب: 1500 جزء في المليون.

السؤال: ما هي مواعيد تزهير الزيتون؟
الجواب: من منتصف مارس إلى منتصف أبريل، وقد يمتد قليلاً حسب التغيرات الجوية.

السؤال: هل عباد الشمس والذرة الصفراء يجودان في وادي سعال؟
الجواب: نعم يجودان.


ثانياً: التربة، الري، والتسميد

السؤال: ما هي توصيات خلط المواد العضوية مع التربة عند الزراعة؟
الجواب: يُنصح بخلطها مع التربة في الجورة، ووضعها في السمادة قبل الري بعد الزراعة.

السؤال: ما هي مكونات "خدمة الجورة" لشجر الزيتون؟
الجواب: 15 كجم كمبوست + 0.5 كجم كبريت زراعي + 0.5 كجم سوبر فوسفات الكالسيوم.

السؤال: هل سماد الكتكوت مناسب للزيتون؟
الجواب: لا ينصح بذلك (لا تصلح).

السؤال: ما هي مكونات "الخدمة الشتوية" للأشجار وموعدها؟
الجواب: سماد بلدي مكمور (يُقلب ويرطب شهريًا ويغطى بنشارة خشب)، وتُقدم في ديسمبر ويناير وفبراير.

السؤال: ما هو الكمبوست وما نوعه الموصى به؟
الجواب: مادة عضوية تُباع في المصانع. يفضل الكمبوست النباتي الحيواني الكامل التحلل.

السؤال: هل يمكن استبدال نترات النشادر بالسماد في التسميد؟
الجواب: السماد أفضل (يفضل الكمبوست).

السؤال: هل يوجد بديل للكمبوست أو السباخ البلدي؟
الجواب: لا يوجد بديل.

السؤال: ما هي نصيحة التسميد للخضراوات والمحاصيل الحقلية؟
الجواب: 10 أمتار من سبلة الكتكوت + 50 كجم كبريت زراعي للفدان.

السؤال: هل يمكن وضع الكمبوست على الأرض ثم عمل المصاطب ليصبح الكمبوست داخلها بالكامل؟
الجواب: نعم.

السؤال: كيف يتم التعامل مع محصول الثوم قبل وبعد القلع؟
الجواب: يروى أسبوعًا، ثم يقلع ويترك ليجف، ثم يُربط ويُخزن. يُمنع الري قبل القلع بيومين لضمان جفاف التربة.

السؤال: ما هي مشكلة الكالسيوم الشائعة في بعض الأراضي وكيف تعالج؟
الجواب: نقص الكالسيوم، تعالج بإضافة الأحماض لتيسير الكالسيوم.

السؤال: ما هي أضرار ملوحة التربة الناتجة عن العطش وكيف تعالج؟
الجواب: تؤدي إلى ملوحة التربة. تعالج باستخدام برنامج التسميد والري المناسب، وإضافة معالج ملوحة 2 لتر للفدان كل أسبوعين.

السؤال: ما هي أضرار الإسراف في استخدام الزنك؟
الجواب: الزنك (الخرصين) عنصر مهم للنبات، ولكن الإسراف يجعله عنصرًا ثقيلًا وضارًا. يستخدم بتركيزات قليلة في الرش.

السؤال: ما هي أضرار عدم استخدام برنامج تسميد للزيتون؟
الجواب: يؤدي إلى ملوحة وعدم استخدام برنامج التسميد.

السؤال: ما هي طريقة تجهيز المصاطب للزراعة؟
الجواب: ارتفاع 50-60 سم وعرض 65 سم.

السؤال: هل حفر فجوة بعمق 20 سم في منتصف المصطبة صحيح للحفاظ على الماء؟
الجواب: لا، يفضل عمل جور على المصطبة وحول الشتلة.

السؤال: ما هو نوع الملوحة في تربة النثيلة؟
الجواب: كلوريد الصوديوم وكربونات الكالسيوم (كلاهما).

السؤال: ما هي طريقة تجهيز الكمبوست للاستخدام؟
الجواب: يتم عمل كومة، إضافة كبريت زراعي ويوريا سلفات مغنيسيوم، وترطيبها وتقليبها باستمرار.

السؤال: ما هي نصائح الري للبصل؟
الجواب: يتم تعطيشه بعد اكتمال النمو والتحجيم، والتركيز على تسميد البوتاسيوم ورش سترات البوتاسيوم في المرحلة الأخيرة.

السؤال: ما هي أضرار رش المركبات النحاسية في درجات الحرارة العالية؟
الجواب: لها تأثير سلبي على النمو وتسبب أضرارًا شديدة في مراحل التزهير والعقد وقد تؤدي إلى تساقط التزهير والعقد.

السؤال: هل الكمبوست دائم في التربة؟
الجواب: يتحلل ويمكث في الأراضي الصحراوية 11 شهرًا فقط.

السؤال: ما هي أهمية المادة العضوية في الأراضي الصحراوية؟
الجواب: هي السبب الرئيسي في توفير 30% من احتياج النبات من العناصر، وتساعد التربة الرملية على الاحتفاظ بالمياه. لا يمكن الاستغناء عنها.

السؤال: هل يمكن استبدال سبلة الكتكوت بالسماد السائل لزراعة القرعيات؟
الجواب: (لم يتم الرد بشكل واضح).

السؤال: ما هي أفضل نوع سماد للمحاصيل الحقلية في الأراضي الصحراوية؟
الجواب: السباخ البلدي القديم أو سبلة الكتكوت أو خليط بينهما بنسبة 1:1.

السؤال: ما هي نصائح الري العامة؟
الجواب: الري يوم بعد يوم، أو يوم ويوم، أو 3 مرات في الأسبوع، حسب عوامل مثل طبيعة التربة، درجة الحرارة، نوع المحصول، فترة النمو، درجة الملوحة.

السؤال: هل يجب استخدام مياه حلوة للري؟
الجواب: نعم، يجب استخدام مياه حلوة.

السؤال: ما هو علاج الألياف الموجودة في سبلة الدواجن؟
الجواب: تحتوي على أمونيا، ويجب تخميرها ودفنها بالرمل قبل الاستخدام.

السؤال: ما هي طريقة التعامل مع بذور السمسم قبل الزراعة؟
الجواب: يجب معالجتها بالمبيد الفطري.

السؤال: هل يمكن خلط حمض الفوسفوريك مع زبل الحمام؟
الجواب: نعم، يمكن.

السؤال: ما هو متوسط المسافة بين النباتات والخطوط في مصدات الرياح (مثل الكافور الليموني)؟
الجواب: 1 متر بين النباتات والخطوط، وعمق الخندق 1 إلى 1.5 متر بعد سنة أو سنتين.

ثالثاً: مكافحة الآفات والأمراض

السؤال: ما هي طريقة التعرف على الحشرات غير المعروفة؟
الجواب: يجب عزل الحشرة في برطمان لتفقس وتخرج الحشرة الكاملة للتعرف على نوعها.

السؤال: ما هي أنواع الحشرات الضارة الشائعة؟
الجواب: يرقات أبو العيد، الخنافس، الرعاشات، العناكب، دودة البراعم، التربس.

السؤال: ما هي الحشرات المفترسة المفيدة؟
الجواب: أبو العيد، حشرة الحرة (مفيدة وتتغذى على الحشرات).

السؤال: ما هو علاج دودة البراعم في الزيتون؟
الجواب: رش دايمثويت ثم إمماكتين بنزوات ثم سيتيبان.

السؤال: ما هو علاج البياض والتربس في الزيتون؟
الجواب: رش ريدوميل جولد، ثم كبريت ميكروني بعد 3 أيام، ثم أمستار توب بعد 5 أيام، ثم أكتيلك بعد 5 أيام.

السؤال: ما هي نصائح المكافحة العامة للحشرات؟
الجواب: يجب التأكد من صلاحية المبيدات وجودتها ومصدرها الموثوق. لا يجوز خلط المبيدات الفطرية والحشرية معًا.

السؤال: ما هو التعامل مع "السرطانات" في شجر الزيتون؟
الجواب: يجب إزالتها (قصها)، وهي أفرع تخرج من الساق بجانب التربة.

السؤال: ما هو علاج ذبول ورق اللوبيا بعد العاصفة؟
الجواب: رش إمماكتين بنزوات ثم سيتيبان بعد أسبوع.

السؤال: هل يمكن استخدام مادة ناشرة مع المبيدات الحشرية والفطرية؟
الجواب: نعم، يمكن استخدامها (المبيدات تحتوي على مادة ناشرة بشكل عام).

السؤال: ما هو علاج دودة أوراق السمسم؟
الجواب: رش ديمثويت ثم إمماكتين بنزوات.

السؤال: هل نباتات مثل النيم أو الريحان يمكن أن تؤثر إيجابياً في طرد الحشرات؟
الجواب: نعم، تؤثر، ولكن بعد 3 سنوات للنيم.

السؤال: ما هو علاج الإصابة بالعفن تحت الزيتون؟
الجواب: (لم يذكر علاج مباشر).

رابعاً: نصائح عامة وإدارة المزرعة

السؤال: ما هي أهمية توحيد زراعة المحاصيل؟
الجواب: يضمن الجدوى الاقتصادية، ويسهل التسويق والمتابعة، ويقلل التشتت.

السؤال: ما هي أهمية حفظ النشرات والبوستات الزراعية؟
الجواب: تُعد كدليل للمزارع.

السؤال: ما هي أسباب فشل بعض المزارعين؟
الجواب: الفتاوى والتأليف، عدم متابعة الجروب، عدم متابعة الزيارات الميدانية، وعدم حضور الدورات التدريبية.

السؤال: ما هي أهمية برنامج التسميد والري المناسب؟
الجواب: هو أساس النجاح الزراعي.

السؤال: ما هي نصائح التعامل مع بذور البطيخ بعد الانبات؟
الجواب: يجب زراعتها مباشرة بعد النقع.
`;
const datePalmContext = `
خامساً: زراعة النخيل

السؤال: إزاي أعمل مزرعة نخيل ناجحة في سيناء؟
الجواب: مفتاح نجاح مزرعة النخيل في سيناء هو اختيار الصنف الصح، لأن الظروف المناخية والتربة ونوعية المياه تؤثر على الإنتاج. مبادرة "اسأل واستشير قبل ما تدفع كتير" بتهدف لمساعدتك تتخذ القرارات الصحيحة وتتجنب الأخطاء المكلفة.
الأسئلة المقترحة: ["ما هي أنواع النخيل المناسبة لكل منطقة في سيناء؟", "ما هي مواصفات الفسيلة الجيدة؟", "كيف أجهز الفسيلة قبل الزراعة؟", "ما هي خطوات زراعة النخيل؟", "ما هو نظام الري وأبعاد الزراعة المثالية للنخيل؟"]

السؤال: ما هي أنواع النخيل المناسبة لكل منطقة في سيناء؟
الجواب:
*   **جنوب سيناء (جو حار):** البرحي والمجدول والسيوي، وكمان الأصناف المحلية الموجودة في الطور ووادي فيران.
*   **وسط وشمال سيناء (جو معتدل):** الأصناف الرطبة زي الحياني وبنت عيشة والعجلاني والعمري، ودي كمان بتستخدم في صناعة العجوة ومربحة للمزارعين.
*   **المناطق اللي في الوسط (النهايات، الحمة، السحيمي، أبو رصاصة - خليط بين جنوب ووسط):** البرحي ممكن ينجح فيها بس نسبة الإنتاج مش هتكون 100%، ممكن إنتاجه يوصل لحوالي 70-80% بسبب ملوحة التربة والمياه، وده بيكون معدل اقتصادي كويس.
الأسئلة المقترحة: ["ما هي مواصفات الفسيلة الجيدة؟", "كيف أجهز الفسيلة قبل الزراعة؟", "ما هي خطوات زراعة النخيل؟"]

السؤال: ما هي مواصفات الفسيلة الجيدة للنخيل؟
الجواب:
*   لازم وزن الفسيلة ما يقلش عن 25-30 كجم عشان تكون قوية وتقدر تنمو بسرعة.
*   تكون خالية من الأمراض والآفات خاصة سوسة النخيل الحمراء.
*   الجذور تكون قوية وسليمة، ويفضل تقليم الجذور القديمة لتحفيز تكون جذور جديدة عند الزراعة.
*   إزالة الأوراق الجافة أو التالفة وترك حوالي 4 إلى 5 أوراق عشان الفسيلة تركز طاقتها في النمو، مع ربط الأوراق الباقية بحبل قوي لحماية الجمارة من حرارة الشمس والمطر.
الأسئلة المقترحة: ["كيف أجهز الفسيلة قبل الزراعة؟", "ما هي خطوات زراعة النخيل؟", "ما هو نظام الري وأبعاد الزراعة المثالية للنخيل؟"]

السؤال: كيف أجهز فسيلة النخيل قبل الزراعة؟
الجواب:
*   لو الفسيلة جاية من زراعة الأنسجة: بتحتاج تمر بمرحلة أقلمة تدريجية مع الملوحة لمدة شهر.
*   لو الفسيلة مأخوذة من النخيل الأم: ممكن تتحط في أكياس تربة خاصة لمدة سنة قبل ما تنقل للزراعة الدائمة.
الأسئلة المقترحة: ["ما هي خطوات زراعة النخيل؟", "ما هو نظام الري وأبعاد الزراعة المثالية للنخيل؟", "ما هي مكونات خلطة التربة لزراعة النخيل؟"]

السؤال: ما هي خطوات زراعة النخيل؟
الجواب:
1.  **حفر الحفرة:** حفر حفرة بأبعاد 1 متر في كل الاتجاهات باستخدام رمل خشن لضمان تصريف التربة.
2.  **إضافة الخلطة:** نضيف خلطة من 10 كجم كومبوست متحلل، 1 كجم كبريت زراعي.
3.  **ردم الحفرة:** نردم الحفرة برمل خشن حوالي 5 سم ونغمرها بالمياه عشان نطرد الفراغات الهوائية.
4.  **وضع الفسيلة:** نحط الفسيلة في الحفرة ونضغط عليها كويس.
5.  **الري:** لازم التربة تفضل رطبة بنسبة لا تقل عن 80% في الفترة الأولى لتحفيز نمو الجذور.
*   **ملاحظة:** فبرغم إن التقليم مش ضروري، إلا إنك لازم تحفر نفس الجورة وتستخدم نفس الخلطة، مع ربط الأوراق لحد ما النخلة تكبر وتبدأ تضغط على الحبل.
الأسئلة المقترحة: ["ما هي مكونات خلطة التربة لزراعة النخيل؟", "ما هو نظام الري وأبعاد الزراعة المثالية للنخيل؟"]

السؤال: ما هو نظام الري وأبعاد الزراعة المثالية للنخيل؟
الجواب:
*   **أبعاد الزراعة:**
    *   في الزراعة المكثفة (خاصة في المناطق اللي فيها الأراضي محدودة): المسافات المثالية بين النخيل بتكون حوالي 7×7 متر.
    *   في الزراعة التقليدية: ممكن تكون المسافة 8×8 متر أو أكثر حسب التخطيط.
*   **الري:**
    *   النخيل بيحتاج ري منتظم بكميات معتدلة.
    *   الري بالتنقيط هو الأنسب لأنه بيوفر المياه وبيحافظ على رطوبة التربة.
    *   ضرورة وجود المياه حوالين الفسيلة خصوصا في أول 6 شهور.
    *   لو هتزرع نخيل كبير زي النخل الخشبي اللي بيبقى طوله متر أو أكتر، يجب أيضاً حفر نفس الجورة واستخدام نفس الخلطة وربط الأوراق.
الأسئلة المقترحة: ["هل يجب تقليم النخيل قبل الزراعة؟", "ما هي أنواع النخيل المناسبة لجنوب سيناء؟"]

السؤال: هل يجب تقليم النخيل قبل الزراعة؟
الجواب: (التقليم ليس ضروريا جدا ولكن يفضل إزالة الأوراق الجافة والتالفة كما ذكر في مواصفات الفسيلة الجيدة).

السؤال: ما هي مكونات خلطة التربة لزراعة النخيل؟
الجواب: خلطة من 10 كجم كومبوست متحلل، 1 كجم كبريت زراعي، ثم ردم الحفرة برمل خشن حوالي 5 سم.

السؤال: هل يجب استخدام أكياس تربة خاصة لفسائل النخيل قبل الزراعة؟
الجواب: نعم، إذا كانت الفسيلة مأخوذة من النخيل الأم، يمكن وضعها في أكياس تربة خاصة لمدة سنة قبل النقل للزراعة الدائمة.

السؤال: هل حجم الفسيلة يؤثر على نجاح زراعة النخيل؟
الجواب: نعم، يجب أن لا يقل وزن الفسيلة عن 25-30 كجم لضمان نمو قوي وسريع.

السؤال: ما هي أهمية اختيار الصنف الصحيح للنخيل؟
الجواب: اختيار الصنف الصحيح هو مفتاح نجاح المزرعة لأنه يؤثر على الإنتاج ويتناسب مع الظروف المناخية والتربة ونوعية المياه.

السؤال: كيف أحمي جمارة النخلة بعد الزراعة؟
الجواب: يجب ربط الأوراق الباقية بحبل قوي لحماية الجمارة من حرارة الشمس والمطر.

السؤال: ما هي مشاكل النخيل الشائعة؟
الجواب: الأمراض والآفات، خاصة سوسة النخيل الحمراء. كما أن ملوحة التربة والمياه قد تقلل من نسبة الإنتاج.
`;
const oliveSeedlingCareContext = `
سادساً: برنامج العناية بشاتلات الزيتون

السؤال: ما هو برنامج العناية بشاتلات الزيتون؟
الجواب: برنامج العناية بشاتلات الزيتون يشمل حماية الشتلات قبل الزراعة، بالإضافة إلى برنامج تسميد وري شهرياً. هل تود معرفة تفاصيل الحماية أو برنامج التسميد والري لشهور محددة؟
الأسئلة المقترحة: ["كيف أحمي شتلات الزيتون قبل الزراعة؟", "ما هو برنامج تسميد وري شتلات الزيتون في فبراير ومارس؟", "ما هو برنامج تسميد وري شتلات الزيتون في شهر أبريل؟", "ما هو برنامج تسميد وري شتلات الزيتون في يونيو ويوليو؟", "ما هو برنامج تسميد وري شتلات الزيتون في شهر أغسطس؟"]

السؤال: كيف أحمي شتلات الزيتون قبل الزراعة؟
الجواب: يتم وضع الشتلات في حوض مخصص لها في الأرض في مكان مظلل. يجب إزالة الحشائش الموجودة في أكياس الشتلات والتخلص منها بالحرق خارج المزرعة. كما يتم رش الشتلات بمبيدات حشرية وفطرية ومحلول كبريتات النحاس.
الأسئلة المقترحة: ["ما هي المبيدات الحشرية الموصى بها لحماية الشتلات قبل الزراعة؟", "ما هي المطهرات الفطرية المستخدمة لحماية الشتلات؟", "ما هو استخدام محلول كبريتات النحاس في العناية بشاتلات الزيتون؟"]

السؤال: ما هي المبيدات الحشرية الموصى بها لحماية شتلات الزيتون قبل الزراعة؟
الجواب: الدايمثويت أو الملاثيون بمعدل 200 سم لكل 100 لتر ماء.
الأسئلة المقترحة: ["ما هي المطهرات الفطرية المستخدمة لحماية الشتلات؟", "ما هو استخدام محلول كبريتات النحاس في العناية بشاتلات الزيتون؟"]

السؤال: ما هي المطهرات الفطرية المستخدمة لحماية شتلات الزيتون؟
الجواب: رش بمطهر فطري مثل أوكسي كلوريد النحاس بمعدل 200 جم على 100 لتر ماء، بعد 10 أيام من الرشة الحشرية.
الأسئلة المقترحة: ["ما هو استخدام محلول كبريتات النحاس في العناية بشاتلات الزيتون؟", "ما هو برنامج تسميد وري شتلات الزيتون في فبراير ومارس؟"]

السؤال: ما هو استخدام محلول كبريتات النحاس في العناية بشاتلات الزيتون؟
الجواب: يضاف محلول كبريتات النحاس (0.5-1 كجم لكل 100 لتر ماء) لري الشتلات، مع استخدام 200 مل منه كمادة وقائية لأمراض التربة.
الأسئلة المقترحة: ["كيف أحمي شتلات الزيتون قبل الزراعة؟", "ما هو برنامج تسميد وري شتلات الزيتون في فبراير ومارس؟"]

السؤال: ما هو برنامج تسميد وري شتلات الزيتون في فبراير ومارس؟
الجواب:
*   منتصف فبراير: يضاف 2 لتر من معالج الملوحة لكل فدان.
*   الأسبوع الأول (فبراير): إضافة 3 لتر حامض نيتريك لكل فدان (عبر الري بالتنقيط).
*   الأسبوع الثاني (فبراير/مارس): يضاف 3 كجم نترات نشادر لكل فدان.
*   الأسبوع الثالث (مارس): يضاف 2 لتر حامض فوسفوريك لكل فدان.
*   الأسبوع الرابع (مارس): يضاف 3 كجم نترات نشادر لكل فدان.
ملاحظات: في حالة عدم توفر حامض النيتريك، يتم استخدام 3 كجم سماد 19/19/19 أو 20/20/20 بدلًا منه. في حالة عدم توفر نترات النشادر، يتم استخدام 3 كجم سماد 19/19/19 أو 20/20/20 بدلًا منه.
الأسئلة المقترحة: ["ما هو برنامج الرش الورقي لشتلات الزيتون في فبراير ومارس؟", "ما هو بديل حامض النيتريك في التسميد الأرضي؟", "ما هو بديل نترات النشادر في التسميد الأرضي؟"]

السؤال: ما هو برنامج الرش الورقي لشتلات الزيتون في فبراير ومارس؟
الجواب:
يتم رش العناصر الصغرى بمعدل 100 لتر لكل فدان، كالتالي:
*   75 جم زنك مخلبي
*   50 جم حديد مخلبي
*   75 جم بورون
*   50 جم موليبدنم
*   50 جم منجنيز
*   30 سم مادة ناشرة
يتم الرش في الصباح الباكر أو آخر النهار.
الأسئلة المقترحة: ["ما هي كميات العناصر الصغرى في الرش الورقي؟", "ما هو برنامج تسميد وري شتلات الزيتون في شهر أبريل؟"]

السؤال: ما هو برنامج تسميد وري شتلات الزيتون في شهر أبريل؟
الجواب:
برنامج التسميد:
*   الأسبوع الأول: يضاف 2 لتر من معالج الملوحة لكل فدان، ويتم إضافة 3 كجم نترات نشادر لكل فدان.
*   الأسبوع الثاني: يضاف 2 لتر حامض فوسفوريك لكل فدان، ويتم استخدام 3 كجم نترات نشادر لكل فدان.
*   الأسبوع الثالث: يضاف 3 لتر حامض نيتريك لكل فدان، ويتم استخدام 3 كجم نترات نشادر لكل فدان.
*   الأسبوع الرابع: يضاف 2 لتر حامض فوسفوريك لكل فدان، ويتم إضافة 3 لتر حامض نيتريك لكل فدان.
ملاحظة: في حالة عدم توفر نترات النشادر، يتم استخدام 5 كجم سماد 19/19/19 أو 20/20/20 بدلًا منه.
برنامج الري:
*   شتلات عمر سنة أو أكثر: 10 لتر ماء يوميًا أو 20 لتر يوم بعد يوم.
*   شتلات حديثة عمر ستة أشهر: 8 لتر ماء يوميًا أو 16 لتر يوم بعد يوم.
الأسئلة المقترحة: ["ما هو بديل نترات النشادر في تسميد أبريل؟", "كمية الري لشتلات الزيتون في أبريل؟", "ما هو برنامج تسميد وري شتلات الزيتون في شهر مايو؟"]

السؤال: ما هو برنامج تسميد وري شتلات الزيتون في شهر مايو؟
الجواب:
برنامج التسميد:
*   الأسبوع الأول: مع الرية الأولى يضاف 2 لتر من معالج الملوحة لكل فدان. مع الرية الثانية إضافة 3 لتر حامض نيتريك لكل فدان.
*   الأسبوع الثاني: مع الرية الأولى يضاف 2 لتر حامض فوسفوريك لكل فدان. مع الرية الثانية إضافة 3 كجم سلفات بوتاسيوم لكل فدان.
*   الأسبوع الثالث: مع الرية الأولى يضاف 2 لتر من معالج الملوحة لكل فدان. مع الرية الثانية إضافة 3 لتر حامض نيتريك لكل فدان.
*   الأسبوع الرابع: مع الرية الأولى إضافة 4 كجم نترات نشادر لكل فدان. مع الرية الثانية إضافة 2 لتر حامض فوسفوريك لكل فدان.
ملاحظة: في حالة عدم توفر نترات النشادر، يتم استخدام 5 كجم سماد 19/19/19 أو 20/20/20 بدلًا منه.
برنامج الري: 12 لتر ماء يوميًا أو 24 لتر يوم بعد يوم.
الأسئلة المقترحة: ["ما هي كمية الري لشتلات الزيتون في مايو؟", "ما هو برنامج تسميد وري شتلات الزيتون في يونيو ويوليو؟", "ما بديل نترات النشادر في تسميد مايو؟"]

السؤال: ما هو برنامج تسميد وري شتلات الزيتون في يونيو ويوليو؟
الجواب:
برنامج التسميد:
*   الأسبوع الأول: مع الرية الأولى يضاف 2 لتر من معالج الملوحة لكل فدان. مع الرية الثانية يضاف 3 لتر حامض نيتريك لكل فدان. ملاحظة: في حالة عدم توفر حامض النيتريك يضاف 4 كجم نترات نشادر أو استخدام 5 كجم سماد 19/19/19 بدلًا منه.
*   الأسبوع الثاني: مع الرية الأولى يضاف 2 لتر حامض فوسفوريك لكل فدان. مع الرية الثانية يضاف 4 كجم نترات نشادر لكل فدان. ملاحظة: في حالة عدم توفر نترات النشادر يتم استخدام 5 كجم سماد 19/19/19 أو 20/20/20 بدلًا منه.
*   الأسبوع الثالث: مع الرية الأولى يضاف 2 لتر من معالج الملوحة لكل فدان. مع الرية الثانية يضاف 3 لتر حامض نيتريك لكل فدان.
*   الأسبوع الرابع: مع الرية الأولى يضاف 4 كجم نترات نشادر لكل فدان. مع الرية الثانية يضاف 2 لتر حامض فوسفوريك لكل فدان.
برنامج الري:
*   شتلات عمرها أقل من سنة: 12 لتر ماء يوميًا أو 24 لتر يوم بعد يوم.
*   شتلات عمرها أكبر من سنة: 16 لتر ماء يوميًا أو 32 لتر يوم بعد يوم.
الأسئلة المقترحة: ["ما بديل حامض النيتريك في تسميد يونيو ويوليو؟", "كمية الري لشتلات الزيتون في يونيو ويوليو حسب العمر؟", "ما هو برنامج تسميد وري شتلات الزيتون في شهر أغسطس؟"]

السؤال: ما هو برنامج تسميد وري شتلات الزيتون في شهر أغسطس؟
الجواب:
برنامج التسميد:
*   الأسبوع الأول: يضاف 2 لتر من معالج الملوحة و3 كجم نترات نشادر لكل فدان.
*   الأسبوع الثاني: يضاف 2 لتر حامض فوسفوريك و5 كجم كبريتات بوتاسيوم لكل فدان.
*   الأسبوع الثالث: يضاف 2 لتر من معالج الملوحة و3 كجم نترات نشادر لكل فدان.
*   الأسبوع الرابع: يضاف 2 لتر حامض هيوميك لكل فدان، ويتم استخدام الرش الورقي.
الرش الورقي:
*   رش العناصر الصغرى: 100 لتر ماء لكل فدان، كالتالي:
    *   50 جم زنك مخلبي
    *   50 جم حديد مخلبي
    *   75 جم بورون
    *   50 جم موليبدنم
    *   50 جم منجنيز
    *   30 سم مادة ناشرة
    *   الرش في الصباح الباكر أو آخر النهار.
برنامج الري:
*   شتلات عمرها أقل من سنة: 12 لتر ماء يوميًا أو 24 لتر يوم بعد يوم.
*   شتلات عمرها أكبر من سنة: 16 لتر ماء يوميًا أو 32 لتر يوم بعد يوم.
الأسئلة المقترحة: ["تفاصيل الرش الورقي لشتلات الزيتون في أغسطس؟", "كمية الري لشتلات الزيتون في أغسطس حسب العمر؟", "ما هو برنامج تسميد وري شتلات الزيتون في شهر سبتمبر؟"]

السؤال: ما هو برنامج تسميد وري شتلات الزيتون في شهر سبتمبر؟
الجواب:
برنامج التسميد:
*   الأسبوع الأول: مع الرية الأولى يضاف 2 لتر معالج ملوحة، مع الرية الثانية 3 كجم نترات نشادر، ومع الرية الثالثة 2 كجم سلفات بوتاسيوم لكل فدان. (بديل نترات النشادر: 5 كجم سماد 19/19/19 أو 20/20/20).
*   الأسبوع الثاني: مع الرية الأولى 2 لتر حامض نيتريك، ومع الرية الثانية 5 كجم كمبوست سائل أو منقوع سبلة دواجن لكل فدان. الرية الثالثة بدون تسميد. (بديل حامض النيتريك: 5 كجم سماد 19/19/19 أو 20/20/20).
*   الأسبوع الثالث: مع الرية الأولى 3 كجم نترات نشادر، ومع الرية الثانية 2 لتر معالج ملوحة، ومع الرية الثالثة ضخ 2 لتر حامض فوسفوريك لكل فدان.
*   الأسبوع الرابع: مع الرية الأولى 3 كجم نترات نشادر، ومع الرية الثانية 5 كجم كمبوست سائل أو منقوع سبلة دواجن لكل فدان. الرية الثالثة ري غسيل فقط.
برنامج الري:
*   شتلات عمرها أقل من سنة: 12 لتر ماء يوميًا أو 24 لتر يوم بعد يوم.
*   شتلات عمرها أكبر من سنة: 20 لتر ماء يوميًا أو 40 لتر يوم بعد يوم.
*   يمنع الري من الساعة العاشرة صباحًا حتى السادسة مساءً.
الأسئلة المقترحة: ["كمية الري لشتلات الزيتون في سبتمبر حسب العمر؟", "ما هو بديل نترات النشادر في تسميد سبتمبر؟", "ماذا يعني ري غسيل؟"]

`;
const oliveGeneralPlantingContext = `
سابعاً: زراعة الزيتون وتجهيز الأرض (دليل شامل)

السؤال: ما هو دليل زراعة الزيتون؟
الجواب: دليل زراعة الزيتون يشمل تجهيز الأرض، حفر الجور، تغذية التربة، بدء الزراعة، تحديد المسافات، اختيار الأصناف، مواصفات الشتلة الجيدة، موعد الزراعة، نصائح للتلقيح، ونصائح هامة قبل وأثناء الزراعة.
الأسئلة المقترحة: ["كيف أجهز الأرض لزراعة الزيتون؟", "ما هي مسافات زراعة الزيتون الموصى بها؟", "ما هي أفضل أصناف الزيتون للزراعة؟", "ما هي مواصفات شتلة الزيتون الجيدة؟", "ما هو أفضل موعد لزراعة الزيتون؟"]

السؤال: كيف أجهز الأرض لزراعة الزيتون؟
الجواب: ابدأ بتسوية وتمهيد تربة المزرعة جيداً. قم بعمل طريق في المنتصف بعرض 5 متر لتسهيل الخدمة، واعمل سياج حول مزرعتك.
الأسئلة المقترحة: ["كيف أحضر خلطة التربة لزراعة الزيتون؟", "ما هي أبعاد الحفرة لزراعة الزيتون؟"]

السؤال: ما هي أبعاد الحفرة لزراعة الزيتون؟
الجواب: جهز حفرة بأبعاد 50×50×50 سم لزراعة أشجار الزيتون أو الفاكهة.
الأسئلة المقترحة: ["كيف أحضر خلطة التربة لزراعة الزيتون؟", "ما هي خطوات بدء زراعة شتلات الزيتون؟"]

السؤال: كيف أحضر خلطة التربة لزراعة الزيتون؟
الجواب: اخلط 15 كجم كمبوست نباتي + 0.5 كجم سوبر فوسفات + 0.5 كجم كبريت زراعي. ضع هذه الخلطة في الحفرة مع ناتج الحفر وامزجهم جيداً، واردم الحفرة، وركب خراطيم الري، واتركها تتخمر لمدة أسبوع.
الأسئلة المقترحة: ["ما هي خطوات بدء زراعة شتلات الزيتون؟", "ما هي أهمية تخمير خلطة التربة قبل الزراعة؟"]

السؤال: ما هي خطوات بدء زراعة شتلات الزيتون؟
الجواب: بعد أن تتخمر الخلطة لمدة أسبوع، ابدأ في زراعة الشتلات الصغيرة.
الأسئلة المقترحة: ["ما هي مسافات زراعة الزيتون الموصى بها؟", "ما هي مواصفات شتلة الزيتون الجيدة؟"]

السؤال: ما هي مسافات زراعة الزيتون الموصى بها؟
الجواب:
*   **للزراعة المكثفة:** 2 × 3 متر.
*   **للزراعة التقليدية:** 5 × 5 متر.
الأسئلة المقترحة: ["ما هي أفضل أصناف الزيتون للزراعة؟", "ما هي مواصفات شتلة الزيتون الجيدة؟"]

السؤال: ما هي أفضل أصناف الزيتون للزراعة؟
الجواب:
*   **للزراعة المكثفة:** كوروناكي، أربوزانا، أربكوين.
*   **للزراعة التقليدية:** بيكوال، منزانيللو، كوراتينا، مراقي، شملالي.
الأسئلة المقترحة: ["ما هي مواصفات شتلة الزيتون الجيدة؟", "ما هو أفضل موعد لزراعة الزيتون؟", "ما هي نصائح التلقيح لأشجار الزيتون؟"]

السؤال: ما هي مواصفات شتلة الزيتون الجيدة؟
الجواب: يجب أن تكون الشتلة من مصدر موثوق، ارتفاعها 50-80 سم، ذات ساق واحدة، خالية من الحشائش، وخالية من الآفات والأمراض. يفضل عدم الري قبل الزراعة بيومين لتتماسك التربة حول الجذور.
الأسئلة المقترحة: ["ما هو أفضل موعد لزراعة الزيتون؟", "ما هي نصائح هامة قبل زراعة الزيتون بخصوص ملوحة المياه؟"]

السؤال: ما هو أفضل موعد لزراعة الزيتون؟
الجواب: أفضل موعد للزراعة هو: مارس - أبريل، وسبتمبر - أكتوبر. يمكن الزراعة في مايو – يونيو – يوليو – أغسطس لكن بحذر.
الأسئلة المقترحة: ["ما هي نصائح التلقيح لأشجار الزيتون؟", "ما هي نصائح هامة قبل زراعة الزيتون بخصوص ملوحة المياه؟"]

السؤال: ما هي نصائح التلقيح لأشجار الزيتون؟
الجواب: لضمان أفضل تلقيح لأشجارك، يفضل زراعة صنف "كوروناكي" كسياج حول المزرعة. يعتبر محصول إضافي، غير مرهق في الخدمة، وله نفس البرنامج في المكافحة.
الأسئلة المقترحة: ["ما هي نصائح هامة قبل زراعة الزيتون بخصوص ملوحة المياه؟", "ماذا يجب أن أفعل عند زراعة شتلات الزيتون؟"]

السؤال: ما هي نصائح هامة قبل زراعة الزيتون (أقلم شتلاتك الأول!)؟
الجواب: خاصة إذا كانت ملوحة مياه البئر 2000 جزء فيما فوق، أحضر الشتلات قبل الزراعة بشهر وارويها مرتين أسبوعياً كما يلي:
*   الأسبوع الأول: تروي مرة بمياه الآبار ومرة بمياه قليلة الملوحة.
*   الأسبوع الثاني: الري مرتين بمياه الآبار.
*   الأسبوع الثالث: تروي مرة بمياه الآبار ومرة بمياه قليلة الملوحة.
*   الأسبوع الرابع: الري مرتين بمياه الآبار.
الأسئلة المقترحة: ["ماذا يجب أن أفعل عند زراعة شتلات الزيتون؟", "لماذا أقلم شتلات الزيتون قبل الزراعة؟"]

السؤال: ماذا يجب أن أفعل عند زراعة شتلات الزيتون؟
الجواب: عند الزراعة، من المهم جداً أن تنزع كيس الشتلة قبل الزراعة، ويتم الري حسب البرنامج الشهري والذي يتم إعداده بناءً على عمر الشتلة ودرجات الحرارة المتوقعة. لا تتبع أي برنامج للتسميد حتى تظهر نموات حديثة على الشتلات.
الأسئلة المقترحة: ["متى أبدأ بتسميد شتلات الزيتون بعد الزراعة؟", "كيف أجهز خلطة الزراعة للزيتون؟"]
`;
const sesameContext = `
ثامناً: السمسم

السؤال: ما هي أهمية محصول السمسم؟
الجواب: السمسم محصول استراتيجي هام صناعياً وزراعياً، يدخل ضمن محاصيل الزيوت الهامة، ومصدر مهم في الصناعات الغذائية مثل الحلوى والطحينة. هو أيضاً محصول غير مرهق وذو تكاليف محدودة في الموسم الصيفي.
الأسئلة المقترحة: ["ما هي أهم أصناف السمسم؟", "ما هو معدل التقاوي لزراعة السمسم؟", "ما هي التربة المناسبة لزراعة السمسم؟"]

السؤال: ما هي أهم أصناف السمسم؟
الجواب:
*   **شندويل:** سمسم أبيض، يُزرع صيفياً في أبريل، متوفر في مركز البحوث الزراعية ومعهد بحوث المحاصيل الزيتية.
*   **ذيل الجمل:** سمسم أحمر، يُزرع صيفياً في أبريل - مايو، صنف محلي متوفر تجارياً في منطقة أبو المطامير - البحيرة.
الأسئلة المقترحة: ["ما هو معدل التقاوي لزراعة السمسم؟", "ما هي مواعيد زراعة السمسم؟", "كيف تتم الزراعة على مصاطب؟"]

السؤال: ما هو معدل التقاوي لزراعة السمسم؟
الجواب: يتراوح معدل التقاوي من 4-5 كجم / فدان، ويقل إلى 2-3 كيلو فقط للفدان في حالة الزراعة الآلية. يجب معاملة التقاوي بالمطهرات الفطرية لحماية البذور والبادرات من الأمراض الفطرية التي قد تكون موجودة في الأرض أو بالتقاوي.
الأسئلة المقترحة: ["لماذا يجب معاملة تقاوي السمسم بالمطهرات الفطرية؟", "كيف تتم الزراعة على مصاطب؟"]

السؤال: كيف تتم الزراعة على مصاطب للسمسم؟
الجواب: تتم الزراعة آلياً باستخدام البلانتر اليدوي أو السطارة الميكانيكية في المساحات الكبيرة، أو يدوياً على جانبي خرطوم الري.
الأسئلة المقترحة: ["ما هي نصائح الري للسمسم؟", "كيف أعد الأرض لزراعة السمسم؟"]

السؤال: ما هي نصائح الري للسمسم؟
الجواب: يجب أن يكون الري منتظماً دون تعطيش لتجنب إجهاد النبات، مع تعديل فتراته حسب نوع التربة والظروف الجوية. يفضل الري يوم بعد يوم أو مرتين أسبوعياً في التربة الرملية، مع تجنب الري وقت الظهيرة أو أثناء الرياح الشديدة، خاصة في مرحلة التزهير.
الأسئلة المقترحة: ["ما هي التربة المناسبة لزراعة السمسم؟", "متى أزرع السمسم؟"]

السؤال: ما هي التربة المناسبة لزراعة السمسم؟
الجواب: معظم الأراضي مناسبة لزراعة السمسم ما عدا الأراضي المرتفعة الملوحة. من الضروري أن تكون التربة خفيفة، رملية أو طينية، وخالية من الصخور والطبقات الكلسية المتحجرة. يجب أن تكون التربة أيضاً خالية من القلوية الشديدة أو الملوحة الزائدة.
الأسئلة المقترحة: ["ما هي مواعيد زراعة السمسم؟", "كيف أعد الأرض لزراعة السمسم؟", "ما هي علامات عدم صلاحية التربة لزراعة السمسم؟"]

السؤال: ما هي مواعيد زراعة السمسم؟
الجواب: يفضل زراعة السمسم في الموسم الصيفي المبكر (مارس وأبريل) أو الصيفي (مايو ويونيو).
الأسئلة المقترحة: ["كيف أعد الأرض لزراعة السمسم؟", "ما هو برنامج تسميد السمسم؟"]

السؤال: كيف أعد الأرض لزراعة السمسم؟
الجواب: يتم حرث الأرض جيداً بعمق 30 سم مع فج الخطوط ووضع السماد العضوي أو سبله الكتكوت. يتم بعد ذلك عمل مصاطب بعرض من 60 – 80 سم حسب عرض البتانة، ويوضع خرطوم الري في منتصف المصطبة.
الأسئلة المقترحة: ["ما هو برنامج تسميد السمسم من الإنبات حتى 45 يوم؟", "ما هي النصائح الهامة قبل زراعة السمسم؟"]

السؤال: ما هو برنامج تسميد السمسم من تمام الإنبات حتى عمر 45 يوم؟
الجواب:
*   سماد 19-19-19: 3 كجم مرة أسبوعياً.
*   سلفات نشادر: 3 كجم مرة أسبوعياً.
*   معالج الملوحة: 1 لتر مرة كل 3 أسابيع.
*   نترات الكالسيوم: 3 كجم + 1 لتر حامض نتريك أسبوعياً.
*   سلفات بوتاسيوم: 1.5 كجم مرة أسبوعياً.
*   حامض فوسفوريك: 1 كجم مرة في الأسبوع.
الأسئلة المقترحة: ["ما هو برنامج تسميد السمسم بعد 45 يوم وحتى 70 يوم؟", "ما هو برنامج تسميد السمسم من 70 إلى 80 يوم؟", "ما هي الأسمدة التي يمكن خلطها للسمسم؟"]

السؤال: ما هو برنامج تسميد السمسم بعد 45 يوم وحتى عمر 70 يوم؟
الجواب:
*   سلفات نشادر: 5 كجم مرتين أسبوعياً.
*   نترات الكالسيوم: 5 كجم + 1 لتر حامض نتريك أسبوعياً.
*   سلفات بوتاسيوم: 2 كجم ثلاث مرات بالأسبوع.
*   حامض فوسفوريك: 2 كجم مرتين بالأسبوع.
الأسئلة المقترحة: ["ما هو برنامج تسميد السمسم من 70 إلى 80 يوم؟", "ما هو التسميد الورقي الموصى به للسمسم؟"]

السؤال: ما هو برنامج تسميد السمسم من 70 إلى 80 يوم؟
الجواب:
*   نترات الكالسيوم: 5 كجم + 1 لتر حامض نتريك مرة واحدة.
*   سلفات بوتاسيوم: 2 كجم ثلاث مرات.
*   حامض فوسفوريك: 2 كجم ثلاث مرات.
مع الاهتمام بالتسميد الورقي بالمخصبات مرتفعة الفوسفور - الكالسيوم بورون كل 10 - 15 يوم، خاصة مع بداية مرحلة التزهير. (ملاحظة: هذا البرنامج استرشادي ويختلف حسب طبيعة التربة ونوعية مياه الري).
الأسئلة المقترحة: ["ما هي علامات نضج السمسم؟", "كيف يتم حصاد السمسم؟", "ما هي كمية المحصول المتوقعة من السمسم؟"]

السؤال: ما هي علامات نضج السمسم؟
الجواب: من علامات نضج محصول السمسم المميزة اصفرار الأوراق الطبيعي، وتحول لون القرون للون البني المائل للصفرة.
الأسئلة المقترحة: ["كيف يتم حصاد السمسم؟", "ما هي كمية المحصول المتوقعة من السمسم؟"]

السؤال: كيف يتم حصاد السمسم؟
الجواب: بعد اصفرار الأوراق وتحول لون القرون للبني المائل للصفرة، تتم عملية الحصاد بقطع النباتات وجمعها وتركها بالجرن حتى جفافها، ثم تدق لاستخراج البذور.
الأسئلة المقترحة: ["ما هي كمية المحصول المتوقعة من السمسم؟", "ما هي استخدامات حطب السمسم؟"]

السؤال: ما هي كمية المحصول المتوقعة من السمسم؟
الجواب: يتراوح محصول السمسم من 300-600 كجم / فدان، بالإضافة إلى ما يقارب 2 طن من حطب السمسم يمكن استعمالها في عمل الكمبوست. ويمكن الحصول على منتج ثانوي من عسل النحل في حالة وجود منحل.
الأسئلة المقترحة: ["ما هي نصائح هامة قبل زراعة السمسم؟", "ما هي الأسمدة التي يمكن خلطها للسمسم؟"]

السؤال: ما هي نصائح هامة قبل زراعة السمسم؟
الجواب:
*   ارتفاع ملوحة مياه الري أكثر من 3000 جزء يضر بالمحصول.
*   يجب تجهيز الأرض جيداً والتخلص من بقايا المحصول السابق.
*   تتم الزراعة والأرض جافة على مصاطب مرتفعة.
*   استخدم خراطيم ري 30GR سم.
*   يتم الري بعد الزراعة مع حقن معالج ملوحة مع رية التخمير.
الأسئلة المقترحة: ["ما هي الأسمدة التي لا يمكن خلطها للسمسم؟", "ما هي أفضل أصناف السمسم؟"]

السؤال: ما هي الأسمدة التي يمكن خلطها لنبات السمسم؟
الجواب: يمكنك خلط سلفات نشادر مع سلفات بوتاسيوم، سلفات نشادر مع حامض فوسفوريك، سلفات بوتاسيوم مع سلفات نشادر، سلفات بوتاسيوم مع حامض فوسفوريك، حامض فوسفوريك مع سلفات نشادر، وحامض فوسفوريك مع سلفات بوتاسيوم.
الأسئلة المقترحة: ["ما هي الأسمدة التي لا يمكن خلطها للسمسم؟", "ما هو التسميد الورقي للسمسم؟"]

السؤال: ما هي الأسمدة التي لا يمكن خلطها لنبات السمسم؟
الجواب: احذر! معالج الملوحة لا يمكن خلطه مع أي سماد آخر. نترات الكالسيوم أيضاً لا يمكن خلطه مع أي سماد آخر.
الأسئلة المقترحة: ["ما هي التربة المناسبة لزراعة السمسم؟", "ما هي مواعيد زراعة السمسم؟"]
`;
const pricklyPearContext = `
تاسعاً: التين الشوكي

السؤال: ما هي أهمية التين الشوكي؟
الجواب: أعلنت منظمة الأمم المتحدة للأغذية والزراعة (الفاو) أن للتين الشوكي مكانة هامة لمجابهة التغيرات المناخية في المستقبل، بفضل ما يتميز به من قيمة غذائية للإنسان والحيوان، بالإضافة إلى كونه مصدراً للماء.
الأسئلة المقترحة: ["ما هي الظروف البيئية المناسبة لنمو التين الشوكي؟", "ما هي الأهمية الاقتصادية للتين الشوكي؟", "كيف يتكاثر التين الشوكي؟"]

السؤال: ما هي الظروف البيئية المناسبة لنمو التين الشوكي؟
الجواب: تنمو نباتات التين الشوكي في المناطق الجافة وشبه الجافة في أنواع مختلفة من التربة الفقيرة. يتحمل التين الشوكي ملوحة ماء الري حتى 3000 جزء في المليون بشرط أن تكون الأرض جيدة الصرف. يجب تجنب زراعته في الأراضي سيئة الصرف.
الأسئلة المقترحة: ["ما هي الأهمية الاقتصادية للتين الشوكي؟", "ما هي أقصى ملوحة يتحملها التين الشوكي؟", "كيف يتكاثر التين الشوكي؟"]

السؤال: ما هي الأهمية الاقتصادية للتين الشوكي؟
الجواب:
*   تستهلك الثمار طازجة لطعمها اللذيذ، وهي غنية بالمعادن الهامة.
*   تستخدم الثمار في صناعة العصائر والمربات والجيلي.
*   يستخلص الزيت الثابت من البذور.
*   تستخدم ألواح التين الشوكي وقشور الثمار كعلف للأبقار والإبل والأغنام في المناطق الجافة وشبه الجافة.
*   يمكن زراعة شجيرات التين الشوكي كسياج مانع يساعد على تثبيت التربة في المزارع الصحراوية.
الأسئلة المقترحة: ["ما هي استخدامات ثمار التين الشوكي؟", "كيف يمكن استخدام التين الشوكي كعلف للحيوان؟", "كيف يمكن استخدام التين الشوكي لتثبيت التربة؟"]

السؤال: كيف يتكاثر التين الشوكي؟
الجواب: يتم إكثار التين الشوكي خضرياً بالألواح، حيث تفصل الألواح وتترك لمدة 7 - 15 يوم في مكان ظليل جيد التهوية لتفقد جزءاً من رطوبتها، مما يسهل استنبات الجذور عليها. تعتبر شهور الربيع والخريف أفضل مواعيد للزراعة.
الأسئلة المقترحة: ["ما هو أفضل موعد لزراعة التين الشوكي؟", "كيف يتم تجهيز الأرض لزراعة التين الشوكي؟", "ما هي مكونات خلطة التربة لزراعة التين الشوكي؟"]

السؤال: ما هو أفضل موعد لزراعة التين الشوكي؟
الجواب: تعتبر شهور الربيع والخريف أفضل مواعيد للزراعة. الشائع هو ميعاد الخريف.
الأسئلة المقترحة: ["كيف يتم تجهيز الأرض لزراعة التين الشوكي؟", "ما هي مكونات خلطة التربة لزراعة التين الشوكي؟"]

السؤال: كيف يتم تجهيز الأرض لزراعة التين الشوكي؟
الجواب: يتم حرث الأرض بعمق 60 - 80 سم وتنظيفها من الحشائش، وتحفر الجور بعمق 50×50 سم.
الأسئلة المقترحة: ["ما هي مكونات خلطة التربة لزراعة التين الشوكي؟", "ما هي مسافات زراعة التين الشوكي؟"]

السؤال: ما هي مكونات خلطة التربة لزراعة التين الشوكي؟
الجواب: يوضع بكل جورة قبل الزراعة 2 - 3 مقطف سماد بلدي مع إضافة 1/2 كجم سوبر فوسفات و 1/2 كجم سلفات نشادر و 1/2 كجم كبريت زراعي.
الأسئلة المقترحة: ["ما هي نصائح الري للتين الشوكي؟", "ما هو برنامج تسميد التين الشوكي؟"]

السؤال: ما هي مسافات زراعة التين الشوكي؟
الجواب: تختلف مسافات الزراعة تبعاً لهدف الإنتاج (الثمار أو العلف). تتم زراعة ألواح التين الشوكي.
الأسئلة المقترحة: ["ما هي نصائح الري للتين الشوكي؟", "ما هو برنامج تسميد التين الشوكي؟"]

السؤال: ما هي نصائح الري للتين الشوكي؟
الجواب: نباتات التين الشوكي ذات احتياجات مائية قليلة، ولكنها تتضرر بالجفاف المطلق. يجب توفير تهوية مناسبة حول الجذور وعدم ركود المياه. تجنب تأخير الري في بداية فصل النمو خلال شهر مارس لتشجيع تفتح البراعم. تقل معدلات الري خلال شهري نوفمبر وديسمبر. حافظ على نباتات في حالة الري الجيد. تتم ري النباتات تحت نظام الري بالتنقيط في الأراضي الرملية.
الأسئلة المقترحة: ["ما هو برنامج تسميد التين الشوكي؟", "متى يجب تجنب تأخير الري للتين الشوكي؟"]

السؤال: ما هو برنامج تسميد التين الشوكي؟
الجواب: التين الشوكي من النباتات ذات الاحتياجات السمادية القليلة. يتم تسميد النبات الواحد تحت نظام الري بالتنقيط كما يلي: يضاف 2 مقطف سماد بلدي خلال فصل الشتاء، وقد يضاف معها ربع كجم سوبر فوسفات، ونصف كجم سلفات نشادر، و100 جم سلفات بوتاسيوم توزع على دفعات حول الشجيرات أثناء موسم النمو الذي يبدأ من أول شهر مارس.
الأسئلة المقترحة: ["ما هو تقليم التين الشوكي؟", "كيف أخف ثمار التين الشوكي؟", "ما هي الآفات والأمراض التي تصيب التين الشوكي؟"]

السؤال: ما هو تقليم التين الشوكي؟
الجواب: يجرى التقليم عادة بعد جمع المحصول في فترة عدم نشاط النمو، بهدف الوصول إلى ارتفاع مناسب لنباتات يسهل على العمال عملية الجمع.
الأسئلة المقترحة: ["كيف أخف ثمار التين الشوكي؟", "ما هي الآفات والأمراض التي تصيب التين الشوكي؟"]

السؤال: كيف أخف ثمار التين الشوكي؟
الجواب: للحصول على ثمار كبيرة الحجم، يجب عدم ترك أكثر من ستة ثمرات بكل لوح بعد عقد الثمار بأسبوعين.
الأسئلة المقترحة: ["ما هي الآفات والأمراض التي تصيب التين الشوكي؟", "ما هي أهمية التين الشوكي لمجابهة التغيرات المناخية؟"]

السؤال: ما هي الآفات والأمراض التي تصيب التين الشوكي؟
الجواب: يصاب التين الشوكي بالتربس، البق الدقيقي، الحشرات القشرية، التبقع البكتيري، التدرن التاجي، عفن الساق، الذبول الفيوزاريمي، ومرض عفن الساق. تعالج الإصابات الحشرية والمرضية باستخدام وسائل المكافحة المتكاملة طبقاً لتوصيات وزارة الزراعة.
الأسئلة المقترحة: ["كيف أعالج إصابات التين الشوكي بالآفات والأمراض؟", "ما هي الظروف البيئية المناسبة لنمو التين الشوكي؟"]
`;
const sunflowerContext = `
عاشراً: دوار الشمس

السؤال: ما هي أهمية دوار الشمس؟
الجواب: دوار الشمس من محاصيل الزيوت الهامة عالمياً، حيث يحتل مرتبة متقدمة بعد نخيل الزيت وفول الصويا والريب. يستخدم النبات كعلف للحيوان، وبذوره للأكل بعد التحميص، ويقدم كغذاء لبعض الطيور. الأصناف الزيتية القصيرة تحتوي على نسبة زيت عالية (45-50%).
الأسئلة المقترحة: ["ما هي أهم أصناف دوار الشمس؟", "ما هو ميعاد زراعة دوار الشمس؟", "ما هي التربة المناسبة لزراعة دوار الشمس؟"]

السؤال: ما هي أهم أصناف دوار الشمس؟
الجواب:
*   **أصناف زيتية قصيرة:** جيزة 120، جيزة 102، سخا 53 (تُزرع صيفياً من أبريل إلى أغسطس).
*   **أصناف تسالي:** جيزة 1 (صنف تسالي طويل)، هجين 5009 (تُزرع صيفياً في أبريل ومايو).
الأسئلة المقترحة: ["ما هو ميعاد زراعة دوار الشمس؟", "ما هو معدل التقاوي لزراعة دوار الشمس؟"]

السؤال: ما هو ميعاد زراعة دوار الشمس؟
الجواب: يفضل زراعة دوار الشمس مرة كل ثلاث سنوات في نفس قطعة التربة. يمكن زراعته طول العام: الموسم الصيفي المبكر (مارس وأبريل)، الصيفي (مايو ويونيو)، أو الصيفي المتأخر (يوليو وأغسطس). يمكن زراعته تحميل على المحاصيل الأخرى والخضر ولا يحتاج إلى عناية خاصة.
الأسئلة المقترحة: ["ما هو معدل التقاوي لزراعة دوار الشمس؟", "كيف تتم زراعة دوار الشمس على مصاطب؟"]

السؤال: ما هو معدل التقاوي لزراعة دوار الشمس؟
الجواب: يتراوح معدل التقاوي من 4-5 كجم / فدان، ويقل إلى 3 كيلو فقط للفدان في حالة الزراعة الآلية. يجب معاملة التقاوي بالمطهرات الفطرية لحماية البذور والبادرات.
الأسئلة المقترحة: ["لماذا يجب معاملة تقاوي دوار الشمس بالمطهرات الفطرية؟", "ما هي نصائح الري لدوار الشمس؟"]

السؤال: كيف تتم زراعة دوار الشمس على مصاطب؟
الجواب: تتم الزراعة آلياً باستخدام البلانتر اليدوي أو السطارة الميكانيكية في المساحات الكبيرة، أو يدوياً على جانبي خرطوم الري.
الأسئلة المقترحة: ["ما هي نصائح الري لدوار الشمس؟", "ما هي التربة المناسبة لزراعة دوار الشمس؟"]

السؤال: ما هي نصائح الري لدوار الشمس؟
الجواب: يجب أن تكون فترات الري منتظمة لتجنب إجهاد النباتات، مع مراعاة نوع التربة والظروف الجوية. في الأراضي الرملية، يكون الري يوماً بعد يوم أو مرتين أسبوعياً مع حقن الأسمدة. تجنب الري وقت الظهيرة أو أثناء هبوب الرياح، واحرص على عدم تعطيش النباتات خاصة في مرحلة التزهير. توقف عن الري قبل النضج الفسيولوجي (اصفرار الجزء الخلفي للقرص وتحول القنابات للون البني).
الأسئلة المقترحة: ["ما هي التربة المناسبة لزراعة دوار الشمس؟", "كيف أعد الأرض لزراعة دوار الشمس؟"]

السؤال: كيف أعد الأرض لزراعة دوار الشمس؟
الجواب: يتم حرث الأرض جيداً بعمق 30 سم مع فج الخطوط ووضع السماد العضوي أو الكمبوست. يتم بعد ذلك عمل مصاطب بعرض من 60 - 80 سم حسب عرض البتانة، ويوضع خرطوم الري في منتصف المصطبة.
الأسئلة المقترحة: ["ما هو برنامج تسميد دوار الشمس من الإنبات حتى 45 يوم؟", "ما هي علامات نضج دوار الشمس؟"]

السؤال: ما هو برنامج تسميد دوار الشمس من تمام الإنبات حتى عمر 45 يوم؟
الجواب:
*   نترات: 3 كجم مرة واحدة أسبوعياً.
*   حامض هيوميك: 2 كجم مرة أسبوعياً.
*   نترات الكالسيوم: 3 كجم + 1 لتر حامض نتريك أسبوعياً.
*   سلفات بوتاسيوم: 1.5 كجم مرة أسبوعياً.
*   حامض فوسفوريك: 1 كجم مرة في الأسبوع.
الأسئلة المقترحة: ["ما هو برنامج تسميد دوار الشمس بعد 45 يوم وحتى 70 يوم؟", "ما هو برنامج تسميد دوار الشمس من 70 إلى 80 يوم؟", "ما هي الأسمدة التي يمكن خلطها لدوار الشمس؟"]

السؤال: ما هو برنامج تسميد دوار الشمس بعد 45 يوم وحتى عمر 70 يوم؟
الجواب:
*   نترات: 5 كجم مرتين أسبوعياً.
*   نترات الكالسيوم: 5 كجم + 1 لتر حامض نتريك أسبوعياً.
*   سلفات بوتاسيوم: 2 كجم ثلاث مرات بالأسبوع.
*   حامض فوسفوريك: 2 كجم مرتين بالأسبوع.
الأسئلة المقترحة: ["ما هو برنامج تسميد دوار الشمس من 70 إلى 80 يوم؟", "ما هو التسميد الورقي الموصى به لدوار الشمس؟"]

السؤال: ما هو برنامج تسميد دوار الشمس من 70 إلى 80 يوم؟
الجواب:
*   نترات الكالسيوم: 5 كجم + 1 لتر حامض نتريك مرة واحدة.
*   سلفات بوتاسيوم: 2 كجم ثلاث مرات.
*   حامض فوسفوريك: 2 كجم ثلاث مرات.
مع الاهتمام بالتسميد الورقي بالكالسيوم بورون المخلبي من خلال الرش الورقي كل 10 - 15 يوم، مع بداية تكوين الأقراص. كما يمكن معاملة البذور بالمخصبات الحيوية مثل البكتريا المثبتة للآزوت والميسرة للفوسفور. (ملاحظة: هذا البرنامج استرشادي ويختلف حسب طبيعة التربة ونوعية مياه الري).
الأسئلة المقترحة: ["ما هي علامات نضج دوار الشمس؟", "كيف يتم حصاد دوار الشمس؟", "ما هي الأسمدة التي لا يمكن خلطها لدوار الشمس؟"]

السؤال: ما هي علامات نضج دوار الشمس؟
الجواب: من علامات نضج دوار الشمس اصفرار ظهر القرص وتلون الحواف باللون البني وجفاف القنابات الزهرية.
الأسئلة المقترحة: ["كيف يتم حصاد دوار الشمس؟", "متى أتوقف عن ري دوار الشمس قبل الحصاد؟"]

السؤال: كيف يتم حصاد دوار الشمس؟
الجواب: تترك النباتات في الحقل لمدة أسبوع بعد ظهور علامات النضج لتقليل رطوبة البذور، ثم يتم حصاد الأقراص وجمعها، وتركها في الجرن حتى تجف، وبعد ذلك تدق لاستخراج البذور. يجب التأكد من جفاف الأقراص بالكامل، ويجب ألا تتجاوز نسبة رطوبة البذور 9-10% لتفادي التزنخ في الأصناف الزيتية.
الأسئلة المقترحة: ["ما هي مشاكل الحشائش والآفات والأمراض في دوار الشمس؟", "ما هي الأسمدة التي يمكن خلطها لدوار الشمس؟"]

السؤال: ما هي مشاكل الحشائش والآفات والأمراض في دوار الشمس؟
الجواب: ينصح بالمكافحة المتكاملة من خلال الممارسات الزراعية واللجوء حال الضرورة إلى المبيدات الكيميائية الموصى بها من وزارة الزراعة.
الأسئلة المقترحة: ["ما هي الأسمدة التي يمكن خلطها لدوار الشمس؟", "ما هي الأسمدة التي لا يمكن خلطها لدوار الشمس؟"]

السؤال: ما هي الأسمدة التي يمكن خلطها لدوار الشمس؟
الجواب: يمكنك خلط نترات مع سلفات نشادر أو سلفات بوتاسيوم أو حامض فوسفوريك. أيضاً سلفات نشادر مع سلفات بوتاسيوم أو حامض فوسفوريك، وسلفات بوتاسيوم مع حامض فوسفوريك.
الأسئلة المقترحة: ["ما هي الأسمدة التي لا يمكن خلطها لدوار الشمس؟", "ما هي التربة المناسبة لزراعة دوار الشمس؟"]

السؤال: ما هي الأسمدة التي لا يمكن خلطها لدوار الشمس؟
الجواب: احذر! حامض الهيوميك لا يمكن خلطه مع أي سماد آخر. نترات الكالسيوم أيضاً لا يمكن خلطه مع أي سماد آخر.
الأسئلة المقترحة: ["ما هي أهم أصناف دوار الشمس؟", "ما هو برنامج تسميد دوار الشمس؟"]
`;
const winterSeasonRecommendations = `
حادي عشر: توصيات زراعة الموسم الشتوي بالتجمعات التنموية 2025/2026

السؤال: ما هي توصيات زراعة الموسم الشتوي 2025/2026؟
الجواب: بناءً على ما تم تسجيله من بيانات خلال الموسم الشتوي السابق، تم تقديم مقترح للزراعة الشتوية للموسم القادم توفيراً للجهد وتسهيلاً للتسويق. التوصيات تختلف حسب التجمعات.
الأسئلة المقترحة: ["ما هي توصيات الزراعة لتجمعات النثيلة وطيبة التمد؟", "ما هي توصيات الزراعة لتجمعات الديفديف والحمة؟", "ما هي توصيات الزراعة لتجمعات السحيمي وبغداد؟", "ما هي الرسالة العامة لتوصيات الموسم الشتوي؟"]

السؤال: ما هي توصيات الزراعة الشتوية لتجمعات النثيلة، طيبة التمد، الخفجة، أسلا وعريق، ووادي سعال؟
الجواب:
*   **المحاصيل المقترحة:** الفول البلدي، القمح، الشعير، بنجر السكر, البصل، الثوم، البسلة، الكمون، والكزبرة.
*   **طريقة الزراعة:** الزراعة على مصاطب مرتفعة في المسافة البينية بين خطوط الأشجار أو في مساحات منفصلة، مع استخدام الري بالتنقيط.
*   **الزراعة الجانبية (مساحات محدودة):** كرنب، قرنبيط، بروكلي، طماطم، فلفل، باذنجان، خس، جرجير، الكرات، والفجل.
الأسئلة المقترحة: ["ما هي كميات التقاوي الموصى بها لهذه التجمعات؟", "ما هي الملاحظات الهامة للتسميد في هذه التجمعات؟"]

السؤال: ما هي كميات التقاوي الموصى بها لفدان واحد في تجمعات النثيلة وطيبة التمد والخفجة وأسلا وعريق ووادي سعال؟
الجواب:
*   **الفول البلدي:** 25 كجم
*   **القمح والشعير:** شيكارتين (إجمالي 70 كجم)
*   **البصل:** 25 قصبة
*   **الثوم:** 350 كجم فصوص
*   **البسلة:** 20 كجم
*   **الكمون:** 10 كجم
*   **الكزبرة (للحبوب):** 10 كجم
*   **الكزبرة (للحش الأخضر):** 25 كجم
الأسئلة المقترحة: ["ما هي الملاحظات الهامة للتسميد؟", "ما هي المحاصيل المقترحة لتجمعات الديفديف والحمة؟"]

السؤال: ما هي الملاحظات الهامة لتسميد وزراعة الموسم الشتوي؟
الجواب:
1.  يفضل استخدام السباخ البلدي أو سبلة الكتكوت بمعدل 20 متر مكعب سباخ بلدي أو 10 متر مكعب سبلة كتكوت.
2.  يضاف 50 كجم كبريت زراعي + 50 كجم سلفات نشادر + 50 كجم سلفات بوتاسيوم.
3.  ينصح بعدم استخدام السوبر فوسفات وعدم حقن هيوميك، ويفضل استخدام معالج ملوحة (المادة الفعالة: أحماض أمينية).
هذه الملاحظات تنطبق على جميع التجمعات.
الأسئلة المقترحة: ["ما هي توصيات الزراعة لتجمعات الديفديف والحمة؟", "ما هي الرسالة العامة للموسم الشتوي؟"]

السؤال: ما هي توصيات الزراعة الشتوية لتجمعات الديفديف، الحمة، أبو رصاصة، النوافعة، خشم القاد، وسهل القاع؟
الجواب:
*   **المحاصيل المقترحة:** القمح، الشعير، بنجر السكر, البصل، الثوم، والبسلة.
*   **طريقة الزراعة:** الزراعة على مصاطب مرتفعة في المسافة البينية بين خطوط الأشجار أو في مساحات منفصلة، مع استخدام الري بالتنقيط.
*   **الزراعة الجانبية (مساحات محدودة):** كرنب، قرنبيط، بروكلي، طماطم، فلفل، باذنجان، خس، وجرجير.
الأسئلة المقترحة: ["ما هي المحاصيل الشتوية المقترحة في الديفديف والحمة؟", "ما هي طريقة الزراعة والري المقترحة في هذه التجمعات؟"]

السؤال: ما هي توصيات الزراعة الشتوية لتجمعات السحيمي، بغداد، طويل الحامض، والجزء الغربي من أبو رصاصة؟
الجواب:
*   **التوصية الرئيسية:** الاكتفاء بالزيتون فقط.
*   **الزراعة الجانبية (مساحات محدودة):** كرنب، قرنبيط، بروكلي، طماطم، فلفل، باذنجان، خس، وجرجير.
الأسئلة المقترحة: ["لماذا يقتصر التركيز على الزيتون في السحيمي وبغداد؟", "ما هي الخضروات المقترحة للزراعة المنزلية في هذه التجمعات؟"]

السؤال: ما هي الرسالة العامة والنصائح الإضافية لتوصيات الموسم الشتوي؟
الجواب:
*   بلدنا وولادنا محتاجة القمح والشعير.
*   التصدير محتاج البصل والثوم.
*   البنجر بدون تعاقد ليس من الضروري زراعته ويمكن البحث عن بديل.
*   أما طبق الفول وقرص الطعمية فهو أساس لكل صباح مصري.
*   لو اجتمعنا على محصول واحد ممكن نكون رقم مهم في المنظومة الزراعية.
*   من الممكن أن ينجح المحصول عندك ولا ينجح عند جارك في نفس التجمع لاختلاف طبيعة الأرض. نتمنى لكم موسم كله خير وبركة.
الأسئلة المقترحة: ["لماذا القمح والشعير مهمان؟", "ما هي النصيحة بخصوص زراعة البنجر؟", "ما أهمية توحيد المحاصيل؟"]
`;
const olivePestControlContext = `
ثاني عشر: برنامج مكافحة الإصابة بالحشرات في الزيتون

السؤال: ما هو برنامج مكافحة الإصابة بالحشرات في الزيتون؟
الجواب: هناك برنامج مقترح لمكافحة الإصابات الحشرية الكثيفة في بداية الموسم الصيفي، يشمل ثلاث رشات بمبيدات مختلفة.
الأسئلة المقترحة: ["ما هي الرشة الأولى في برنامج مكافحة حشرات الزيتون؟", "ما هي الرشة الثانية في برنامج مكافحة حشرات الزيتون؟", "ما هي الرشة الثالثة في برنامج مكافحة حشرات الزيتون؟", "ما هي النصائح الهامة عند رش مبيدات الزيتون؟"]

السؤال: ما هي الرشة الأولى في برنامج مكافحة حشرات الزيتون؟
الجواب: رش بمبيد دايمثويت بمعدل 3 مل لكل لتر. يتم الرش بعد مرور 3 أيام من ملاحظة الإصابة.
الأسئلة المقترحة: ["ما هي الرشة الثانية في برنامج مكافحة حشرات الزيتون؟", "ما هي النصائح الهامة عند رش مبيدات الزيتون؟"]

السؤال: ما هي الرشة الثانية في برنامج مكافحة حشرات الزيتون؟
الجواب: رش بمبيد اللمبادا 5% بمعدل 2 جم لكل لتر. يتم الرش بعد مرور 5 أيام من الرشة الأولى.
الأسئلة المقترحة: ["ما هي الرشة الثالثة في برنامج مكافحة حشرات الزيتون؟", "ما هي النصائح الهامة عند رش مبيدات الزيتون؟"]

السؤال: ما هي الرشة الثالثة في برنامج مكافحة حشرات الزيتون؟
الجواب: رش بمبيد اللمبادا 5% بمعدل 3 مل لكل لتر.
الأسئلة المقترحة: ["ما هي النصائح الهامة عند رش مبيدات الزيتون؟", "متى أستخدم برنامج المكافحة في الزيتون؟"]

السؤال: ما هي النصائح الهامة عند رش مبيدات الزيتون؟
الجواب:
*   يكون الرش آخر النهار بعد العصر بساعة، وخاصة مع مبيد اللمبادا.
*   يتوقف الرش عند وجود رياح شديدة أو أمطار.
*   ارتفاع المفاجئ لدرجات الحرارة ووجود رياح شديدة محمّلة بالأتربة والجراثيم الفطرية، يكون معدل انتشار الآفات سريع جداً.
*   تأكد من شراء المبيدات المطابقة لمواصفات وزارة الزراعة المصرية ومن مصدر موثوق به.
الأسئلة المقترحة: ["متى يكون معدل انتشار الآفات سريعا؟", "كيف أتأكد من جودة المبيدات؟"]
`;
const stormTipsContext = `
ثالث عشر: نصائح هامة للمزارعين (لو العاصفة وصلت مزرعك)

السؤال: ماذا أفعل لو العاصفة وصلت مزرعتي؟
الجواب: يجب البدء بالري فوراً، غسيل النبات ورشة حماية، ومعالجة أي ضرر ظاهر، بالإضافة إلى مكافحة الآفات.
الأسئلة المقترحة: ["ماذا أفعل بالري بعد العاصفة؟", "ماذا أرش على النبات بعد العاصفة لحمايته؟", "كيف أتعامل مع الضرر الظاهر على النبات بعد العاصفة؟", "كيف أكافح الآفات بعد العاصفة؟"]

السؤال: ماذا أفعل بالري بعد العاصفة؟
الجواب: يفضل تسقي النباتات الصبح بدري أو آخر النهار بعد هدوء العاصفة. ولو متوفر عندك، استخدم الأحماض الأمينية (مثل فيرامينا) بتخفيفها مع مياه الري لمساعدة النباتات على تخطي الإجهاد. ولو مش متوفر مياه، فكفاية الري الكويس.
الأسئلة المقترحة: ["ماذا أرش على النبات بعد العاصفة لحمايته؟", "ما أهمية الأحماض الأمينية بعد العاصفة؟"]

السؤال: ماذا أرش على النبات بعد العاصفة لحمايته؟
الجواب: رش سليكات البوتاسيوم أول ما العاصفة تنتهي، عشان تنظف الورق من الأتربة وتحميه من الضرر. استخدم منتجات مثل (فيرانس + توامين بوت) التي تنشط النباتات بسرعة.
الأسئلة المقترحة: ["كيف أتعامل مع الضرر الظاهر على النبات بعد العاصفة؟", "ما أهمية سليكات البوتاسيوم بعد العاصفة؟"]

السؤال: كيف أتعامل مع الضرر الظاهر على النبات بعد العاصفة؟
الجواب: لو فيه ضرر ظاهر على النبات، يبقى الأفضل ترش مبيد فطري زي جلوكانات النحاس أو هيدروكسيد النحاس أولاً.
الأسئلة المقترحة: ["كيف أكافح الآفات بعد العاصفة؟", "ما أهمية رش المبيدات الفطرية بعد العاصفة؟"]

السؤال: كيف أكافح الآفات بعد العاصفة؟
الجواب: العواصف ممكن تجيب معاها جراثيم فطرية وبيض حشرات. بعدها بـ 3 أيام، رش مبيد حشري زي إيماكتين بنزوات. كل ده بنعمله كوقاية مهمة من أي انتشار مفاجئ للآفات، وكمان عشان نقلل الضغط والإجهاد اللي النبات تعرض له.
الأسئلة المقترحة: ["ما هي أهمية المكافحة بعد العاصفة؟", "ما هو نوع المبيد الحشري الموصى به بعد العاصفة؟"]
`;
const onionFertilizationContext = `
رابع عشر: تعليمات تسميد البصل الأرضي والورقي

السؤال: ما هو برنامج تسميد البصل؟
الجواب: برنامج تسميد البصل يتكون من تسميد أرضي ورش ورقي لضمان أفضل نمو وجودة للمحصول.
الأسئلة المقترحة: ["ما هو برنامج التسميد الأرضي للبصل؟", "ما هو برنامج الرش الورقي للبصل؟", "ما هي الأسمدة البديلة لنترات النشادر في تسميد البصل؟"]

السؤال: ما هو برنامج التسميد الأرضي للبصل؟
الجواب:
*   ابدأ بـ 2.5 لتر/فدان لمعالج الملوحة (مرة في الأسبوع).
*   لو عندك نترات نشادر 33.5%: ضيف 7 كجم نترات + 2 لتر حامض فوسفوريك (مرة في الأسبوع).
*   لو مش متوفرة النترات: ممكن تضيف 8 كجم سلفات نشادر + 2 لتر حامض فوسفوريك.
*   كالسيوم: 7 كجم نترات كالسيوم + 2 لتر حامض نيتريك (برضه مرة أسبوعياً).
*   7 كجم بوتاسيوم (سلفات أو سترات حسب المتوفر) + 2 لتر حامض نيتريك.
*   2 لتر فيراداي مرة أسبوعياً.
الأسئلة المقترحة: ["ما هي الأسمدة البديلة لنترات النشادر في تسميد البصل الأرضي؟", "ما هي كمية معالج الملوحة المستخدمة للبصل؟"]

السؤال: ما هو برنامج الرش الورقي للبصل؟
الجواب: اخلط مغذيات مثل توامين بوت + فيرانس + عناصر صغرى (حديد وزنك ومنجنيز) بالتركيزات المكتوبة على العبوات. لا يوجد مانع من رشة كبريت ميكروني بمعدل 500 جرام / 200 لتر مياه. الرش يكون في الصباح الباكر أو أرضاً ندية.
الأسئلة المقترحة: ["ما هي العناصر الصغرى المهمة في رش البصل الورقي؟", "ما أهمية الكبريت الميكروني في رش البصل؟"]

السؤال: ما هي الأسمدة البديلة لنترات النشادر في تسميد البصل الأرضي؟
الجواب: في حالة عدم توفر نترات النشادر، يمكن استخدام 8 كجم سلفات نشادر + 2 لتر حامض فوسفوريك.
الأسئلة المقترحة: ["ما هي أهمية زيادة الهيومين في تسميد البصل؟", "ما هو أفضل وقت لرش البصل؟"]

السؤال: ما هي أهمية زيادة الهيومين في التسميد البصل؟
الجواب: التركيز على زيادة الهيومين في التسميد والمكافحة يفرق جامد في حجم المحصول وجودته.
الأسئلة المقترحة: ["ما هو أفضل وقت لرش البصل؟", "ما هي التعليمات العامة لتسميد البصل؟"]
`;
const garlicHarvestContext = `
خامس عشر: تعليمات حصاد الثوم

السؤال: ما هي تعليمات حصاد الثوم؟
الجواب: لضمان محصول جيد، يجب الانتباه لخطوات ما قبل وأثناء وبعد الحصاد مثل الري قبل القلع، طريقة التقليع، والتنشيف والتخزين.
الأسئلة المقترحة: ["متى يجب أن يتم حصاد الثوم؟", "كيف أجهز الأرض لحصاد الثوم؟", "كيف يتم تقليع الثوم؟", "كيف يتم تنشيف وتخزين الثوم بعد الحصاد؟"]

السؤال: متى يجب أن يتم حصاد الثوم؟
الجواب: الحصاد يكون وقت الضحى.
الأسئلة المقترحة: ["كيف أجهز الأرض لحصاد الثوم؟", "ما أهمية وقت الحصاد؟"]

السؤال: كيف أجهز الأرض لحصاد الثوم؟
الجواب: رشَّة ميه خفيفة قبل القلع بيوم بتسهل الدنيا. لو أرضك تقيلة، أما لو أرضك خفيفة، فلا تحتاج للري.
الأسئلة المقترحة: ["كيف يتم تقليع الثوم؟", "ما هي علامات جاهزية الثوم للحصاد؟"]

السؤال: كيف يتم تقليع الثوم؟
الجواب: يتم التقليع بإيدك لو الأرض سهلة، أو بالمنقرة/الفاس بحذر لو التربة ماسكة.
الأسئلة المقترحة: ["كيف يتم تنشيف وتخزين الثوم بعد الحصاد؟", "ما أهمية الحذر عند تقليع الثوم؟"]

السؤال: كيف يتم تنشيف وتخزين الثوم بعد الحصاد؟
الجواب: سيبه لمدة يوم واحد على ضهر المصطبة بعد القلع لتنشيفه. ثم حزم 3-4 كيلو، وخلي الروس لتحت. يمكن بيعه على طول، أو تخزينه في مكان ضل وجيد التهوية لغاية ما تبيع.
الأسئلة المقترحة: ["ما هي أفضل طريقة لتخزين الثوم؟", "ما هي الأداة الأفضل لتقليع الثوم؟"]
`;
const favaBeanHarvestContext = `
سادس عشر: تعليمات حصاد الفول

السؤال: ما هي تعليمات حصاد الفول؟
الجواب: مشوار التعب قرب على النهاية، وحصاد الفول يتطلب خطوات محددة لضمان أفضل إنتاج.
الأسئلة المقترحة: ["متى يجب أن يتم حصاد الفول؟", "ما هي الأداة المستخدمة لحصاد الفول؟", "ماذا أفعل بجذور الفول بعد الحصاد؟", "كيف يتم رص وجمع الفول بعد الحصاد؟"]

السؤال: متى يجب أن يتم حصاد الفول؟
الجواب: الحصاد يكون الفجر مباشرةً.
الأسئلة المقترحة: ["ما هي الأداة المستخدمة لحصاد الفول؟", "ما هي أهمية توقيت حصاد الفول؟"]

السؤال: ما هي الأداة المستخدمة لحصاد الفول؟
الجواب: استخدم المنجل للحصاد بسهولة وأمان.
الأسئلة المقترحة: ["ماذا أفعل بجذور الفول بعد الحصاد؟", "كيف يتم رص وجمع الفول بعد الحصاد؟"]

السؤال: ماذا أفعل بجذور الفول بعد الحصاد؟
الجواب: سيب الجذور في التربة عشان تفيد الأرض للموسم الجاي.
الأسئلة المقترحة: ["كيف يتم رص وجمع الفول بعد الحصاد؟", "ما أهمية ترك جذور الفول في التربة؟"]

السؤال: كيف يتم رص وجمع الفول بعد الحصاد؟
الجواب: رص الفول على ظهر المصطبة لمدة يومين أو ثلاثة حتى ينشف تماماً، ثم اجمعه في كوم واحد. بعد الجفاف الكامل، استعد لدراسة السوق وضمان أفضل إنتاج.
الأسئلة المقترحة: ["ما هي علامات جفاف الفول؟", "ماذا بعد جمع الفول وتجفيفه؟"]
`;
const rainAlertContext = `
سابع عشر: تنبيه هام للمزارعين (بعد الأمطار)

السؤال: ماذا أفعل بعد الأمطار في مزرعتي؟
الجواب: إذا كان التجمع عندك فيه أمطار، يجب اتباع إجراءات محددة لكافة المحاصيل لضمان صحة النباتات وتقليل الضرر.
الأسئلة المقترحة: ["ماذا أفعل بالري بعد انتهاء الأمطار؟", "ماذا أرش على المحاصيل بعد انتهاء الأمطار؟", "هل يجب استخدام معالج ملوحة بعد الأمطار؟"]

السؤال: ماذا أفعل بالري بعد انتهاء الأمطار؟
الجواب: يكون الري بعد انتهاء الأمطار مباشرةً.
الأسئلة المقترحة: ["ماذا أرش على المحاصيل بعد انتهاء الأمطار؟", "لماذا يجب الري مباشرة بعد الأمطار؟"]

السؤال: ماذا أرش على المحاصيل بعد انتهاء الأمطار؟
الجواب: رش كبريت ميكروني 400 جم / 200 لتر ماء بعد انتهاء الأمطار.
الأسئلة المقترحة: ["هل يجب استخدام معالج ملوحة بعد الأمطار؟", "ما أهمية الكبريت الميكروني بعد الأمطار؟"]

السؤال: هل يجب استخدام معالج ملوحة بعد الأمطار؟
الجواب: لو تقدر، ضيف معالج ملوحة يبقى تمام.
الأسئلة المقترحة: ["ما هي أهمية معالج الملوحة بعد الأمطار؟", "ما هي الإجراءات العامة بعد الأمطار؟"]
`;
const onionPlantingTipsContext = `
ثامن عشر: موسم زراعة البصل - نصائح أساسية

السؤال: ما هي النصائح الأساسية لموسم زراعة البصل؟
الجواب: يجب اختيار الصنف المناسب (أحمر أو ذهبي)، والانتباه للون جذور الشتلات عند الشراء، وقراءة النشرة الإرشادية.
الأسئلة المقترحة: ["ما هي أصناف البصل الموصى بها للزراعة؟", "ماذا يجب أن أركز عليه عند شراء شتلات البصل؟", "أين أجد النشرة الإرشادية لزراعة البصل؟"]

السؤال: ما هي أصناف البصل الموصى بها للزراعة؟
الجواب: عندك صنفين: الأحمر أو الذهبي.
الأسئلة المقترحة: ["ماذا يجب أن أركز عليه عند شراء شتلات البصل؟", "أين أجد النشرة الإرشادية لزراعة البصل؟"]

السؤال: ماذا يجب أن أركز عليه عند شراء شتلات البصل؟
الجواب: ركز مع لون الجذور: لون الجذر الأبيض مقبول، ولون الجذر الأرجواني مرفوض.
الأسئلة المقترحة: ["ماذا يدل لون الجذر الأبيض في شتلات البصل؟", "ماذا يدل لون الجذر الأرجواني في شتلات البصل؟"]

السؤال: ماذا يدل لون الجذر الأبيض في شتلات البصل؟
الجواب: يدل على أنها مقبولة وجيدة.
الأسئلة المقترحة: ["ماذا يدل لون الجذر الأرجواني في شتلات البصل؟", "أين أجد النشرة الإرشادية لزراعة البصل؟"]

السؤال: ماذا يدل لون الجذر الأرجواني في شتلات البصل؟
الجواب: يدل على أنها مرفوضة (علامة خطأ).
الأسئلة المقترحة: ["أين أجد النشرة الإرشادية لزراعة البصل؟", "ما هي النصائح العامة قبل زراعة البصل؟"]

السؤال: أين أجد النشرة الإرشادية لزراعة البصل؟
الجواب: توجد نشرة إرشادية في الجروب (جروب مبادرة اسأل واستشير قبل ما تدفع كتير) ستعرفك كل شيء بالصور.
الأسئلة المقترحة: ["كيف أستفيد من النشرة الإرشادية؟", "ما أهمية توكلنا على الله في الزراعة؟"]
`;
const integratedPestManagementContext = `
تاسع عشر: المكافحة المتكاملة لآفات الفول والثوم والزيتون تحت ظروف سيناء

السؤال: ما هي المكافحة المتكاملة لآفات الزيتون؟
الجواب: تشمل التخلص من نواتج التقليم وتطهير الأشجار بمخلوط الزيت المعدني الشتوي ومبيد دايمثويت، ثم إعادة الرش بمبيد فطري.
الأسئلة المقترحة: ["كيف أتخلص من نواتج تقليم الزيتون؟", "كيف أطهر أشجار الزيتون بعد التقليم؟", "ما هي الرشات الموصى بها بعد تقليم الزيتون؟", "ما هي النصائح الهامة عند شراء مبيدات الزيتون؟"]

السؤال: كيف أتخلص من نواتج تقليم الزيتون؟
الجواب: التخلص من نواتج التقليم وحرقها خارج المزرعة بعد التقليم مباشرة. (رجاء عدم التأخير حتى لا تنتقل الحشرات والفطريات بعد جفاف الأفرع إلى الأشجار المنزرعة).
الأسئلة المقترحة: ["كيف أطهر أشجار الزيتون بعد التقليم؟", "لماذا يجب حرق نواتج التقليم فوراً؟"]

السؤال: كيف أطهر أشجار الزيتون بعد التقليم؟
الجواب: تطهير الأشجار بعد التقليم مباشرة بمخلوط الزيت المعدني الشتوي بمعدل 1.5 لتر ومبيد دايمثويت بمعدل 200 سم لكل 100 لتر مياه. يتم إذابة كل مادة منفردة في 5 لتر ماء ثم خلطهما في تانك الرش معاً.
الأسئلة المقترحة: ["ما هي الرشات الموصى بها بعد تقليم الزيتون؟", "ما هي مكونات مخلوط تطهير الزيتون؟"]

السؤال: ما هي الرشات الموصى بها بعد تقليم الزيتون؟
الجواب: يتم إعادة الرش بمبيد فطري بعد الرشة الأولى بـ 10 أيام. استخدم مبيد أوكسي كلورو النحاس بمعدل 200 جم على 100 لتر مياه (لا يخلط النحاس مع أي مادة ويرش منفرداً).
الأسئلة المقترحة: ["ما هي النصائح الهامة عند شراء مبيدات الزيتون؟", "هل يمكن خلط أوكسي كلورو النحاس مع مبيدات أخرى؟"]

السؤال: ما هي النصائح الهامة عند شراء مبيدات الزيتون؟
الجواب: تأكد من شراء المبيدات المطابقة لمواصفات وزارة الزراعة المصرية ومن مصدر موثوق به.
الأسئلة المقترحة: ["ما هي المكافحة المتكاملة لآفات الفول والثوم؟", "كيف أتأكد من صلاحية المبيدات؟"]

السؤال: ما هي المكافحة المتكاملة لآفات الفول والثوم؟
الجواب: تشمل ثلاث رشاشات محددة: الأولى بالكبريت الميكروني، الثانية بمبيدات مثل شالنجر أو فيرتيميك، والثالثة بمبيدات مثل تريسر أو إيميداكلوبريد.
الأسئلة المقترحة: ["ما هي الرشة الأولى لمكافحة آفات الفول والثوم؟", "ما هي الرشة الثانية لمكافحة آفات الفول والثوم؟", "ما هي الرشة الثالثة لمكافحة آفات الفول والثوم؟", "ما هي النصائح الهامة عند شراء مبيدات الفول والثوم؟"]

السؤال: ما هي الرشة الأولى لمكافحة آفات الفول والثوم؟
الجواب: يتم الرش بالكبريت الميكروني بالتركيز الموصى به على العبوة.
الأسئلة المقترحة: ["ما هي الرشة الثانية لمكافحة آفات الفول والثوم؟", "ما أهمية الكبريت الميكروني في المكافحة؟"]

السؤال: ما هي الرشة الثانية لمكافحة آفات الفول والثوم؟
الجواب: بعد الرشة الأولى بـ 7 أيام، يتم الرش بأحد المبيدات مثل شالنجر أو فيرتيميك بالتركيز الموصى به على العبوة.
الأسئلة المقترحة: ["ما هي الرشة الثالثة لمكافحة آفات الفول والثوم؟", "ما هي النصائح الهامة عند شراء مبيدات الفول والثوم؟"]

السؤال: ما هي الرشة الثالثة لمكافحة آفات الفول والثوم؟
الجواب: بعد الرشة الثانية بـ 7 أيام، يتم الرش بمادة تريسر أو إيميداكلوبريد بالتركيز الموصى به على العبوة.
الأسئلة المقترحة: ["ما هي النصائح الهامة عند شراء مبيدات الفول والثوم؟", "ما هو الفرق بين تريسر وإيميداكلوبريد؟"]

السؤال: ما هي النصائح الهامة عند شراء مبيدات الفول والثوم؟
الجواب: تأكد من شراء المبيدات المطابقة لمواصفات وزارة الزراعة المصرية ومن مصدر موثوق به.
الأسئلة المقترحة: ["كيف أتأكد من صلاحية المبيدات؟", "ما هي أهمية المكافحة المتكاملة للآفات؟"]
`;
// ... End of context data

const agricultureContextCombined = agricultureContext + "\n\n" + datePalmContext + "\n\n" + oliveSeedlingCareContext + "\n\n" + oliveGeneralPlantingContext + "\n\n" + sesameContext + "\n\n" + pricklyPearContext + "\n\n" + sunflowerContext + "\n\n" + winterSeasonRecommendations + "\n\n" + olivePestControlContext + "\n\n" + stormTipsContext + "\n\n" + onionFertilizationContext + "\n\n" + garlicHarvestContext + "\n\n" + favaBeanHarvestContext + "\n\n" + rainAlertContext + "\n\n" + onionPlantingTipsContext + "\n\n" + integratedPestManagementContext;

const PEST_CONTROL_KEYWORDS = ["وقاية", "مكافحة", "مبيدات", "مبيد", "آفات", "آفة", "امراض", "مرض", "سوسة", "حشرات", "حشرة", "فطري", "بكتيري", "عفن", "إصابة", "اصابه"];

const TELEGRAM_TOPIC_KEYWORDS = {
    "نخيل": { type: "فيديو تعليمي", name: "زراعة النخيل" }, "زيتون": { type: "نشرة", name: "زراعة الزيتون" }, "سمسم": { type: "نشرة", name: "زراعة السمسم" }, "تين شوكي": { type: "نشرة", name: "زراعة التين الشوكي" }, "دوار الشمس": { type: "نشرة", name: "زراعة دوار الشمس" }, "قمح": { type: "نشرة", name: "زراعة القمح والمحاصيل الشتوية" }, "بطيخ": { type: "نشرة", name: "زراعة البطيخ" }, "لوبيا": { type: "نشرة", name: "زراعة اللوبيا" }, "لب الجورمة": { type: "نشرة", name: "زراعة البطيخ" } 
};

const getTelegramRedirectionInfo = (input) => {
    const lowerCaseInput = input.toLowerCase();
    for (const [keyword, info] of Object.entries(TELEGRAM_TOPIC_KEYWORDS)) {
        if (lowerCaseInput.includes(keyword)) {
            if (keyword === "زيتون" && PEST_CONTROL_KEYWORDS.some(k => lowerCaseInput.includes(k))) {
                continue;
            }
            return info;
        }
    }
    return null;
};

const SYSTEM_INSTRUCTION = `أنت مساعد ذكي متخصص تابع لمبادرة "اسأل واستشير قبل ما تدفع كتير" من مركز بحوث الصحراء.
مهمتك هي تحويل المعلومات المعقدة من السياق إلى محادثة تفاعلية وسهلة.
**القواعد الأساسية للمحادثة:**
1.  **أسلوب الإجابة التفاعلي (القاعدة الأهم):**
    *   **لا تقدم إجابات طويلة أبداً إلا في حالة برامج تسميد الزيتون الشهرية حيث يجب تقديم تفاصيل كاملة بالأسابيع.** مهمتك هي تقسيم المواضيع الكبيرة إلى أجزاء صغيرة ومفهومة.
    *   عندما يسأل المستخدم سؤالاً، **مهما كان محدداً**، قدم إجابة **موجزة ومباشرة** (جملة أو اثنتين كحد أقصى) ما لم يكن السؤال عن برامج تسميد الزيتون الشهرية.
    *   **بعد كل إجابة تقدمها، يجب عليك دائماً طرح 2-4 أسئلة مقترحة ذات صلة** لمساعدة المستخدم على التعمق في الموضوع خطوة بخطوة. استخدم أداة 'suggestedQuestions' لهذا الغرض.
    *   **مثال تطبيقي (سؤال المستخدم: "ما هو برنامج تسميد القمح؟"):**
        *   **إجابة خاطئة:** (سرد جدول التسميد بالكامل).
        *   **إجابة صحيحة:** "برنامج تسميد القمح يعتمد على عمر النبات. تبدأ المرحلة الأولى من الإنبات حتى عمر 40 يومًا. هل تود معرفة تفاصيل هذه المرحلة؟"
        *   **الأسئلة المقترحة باستخدام الأداة:** ["ما هي كميات الأسمدة لمرحلة أول 40 يومًا؟", "ماذا عن مرحلة التسميد التالية (41-70 يومًا)؟", "هل هناك ملاحظات خاصة بالري أثناء التسميد؟"]
2.  **الاستعلام عن كلمة عامة (مثل "الزيتون" أو "القمح" أو "النخيل" أو "السمسم" أو "التين الشوكي" أو "دوار الشمس" أو "الموسم الشتوي" أو "مكافحة الآفات" أو "البصل" أو "الثوم" أو "الفول" أو "العاصفة" أو "الأمطار" أو "حصاد"):**
    *   إذا أدخل المستخدم كلمة عامة، رحب به ("بالتأكيد، يمكنني المساعدة بخصوص [الكلمة المدخلة].") ثم قدم 3-4 أسئلة مقترحة واسعة حول الموضوع لتبدأ المحادثة.
3.  **لا تقم بإضافة أي نص يتعلق بروابط التلجرام أو تشجع على زيارة التلجرام مباشرةً في ردودك. هذه المهمة ستتم برمجياً بعد ردك.**
4.  **عندما تكون الإجابة غير متوفرة (توجيه الخبراء - الواتساب):**
    *   **لمعلومات شهر يوليو للزيتون:** إذا سأل المستخدم عن برنامج الزيتون لشهر يوليو، أجب بأن برنامج يوليو يتبع برنامج شهر يونيو. وقدم تفاصيل برنامج شهر يونيو المتاحة. إذا كان هناك أسئلة أكثر تفصيلاً أو لم يتمكن النموذج من الإجابة بدقة، وجه المستخدم للتواصل مع الأستاذ الدكتور/ أحمد عماد على جروب الواتس اب الخاص بمبادرة 'اسأل واستشير قبل ما تدفع كتير'.
    *   **لمحاصيل الخضر أو المحاصيل الحقلية:** "عذرًا، هذه المعلومة غير متوفرة لدي. للحصول على إجابة دقيقة، يُرجى التواصل مع الأستاذ الدكتور/ محمد رائف على جروب الواتس اب الخاص بمبادرة 'اسأل واستشير قبل ما تدفع كتير'."
    *   **لمحاصيل الفاكهة (عام):** "عذرًا، هذه المعلومة غير متوفرة لدي. للحصول على إجابة دقيقة، يُرجى التواصل مع الأستاذ الدكتور/ أحمد عماد على جروب الواتس اب الخاص بمبادرة 'اسأل واستشير قبل ما تدفع كتير'."
    *   **للنباتات الطبية:** "عذرًا، هذه المعلومة غير متوفرة لدي. للحصول على إجابة دقيقة، يُرجى التواصل مع الأستاذ الدكتور/ محمد عبد الوهاب على جروب الواتس اب الخاص بمبادرة 'اسأل واستشير قبل ما تدفع كتير'."
    *   **للوقاية، المكافحة، المبيدات، أو الإصابة (إذا كانت الإجابة غير متوفرة في السياق أو تتطلب استشارة متخصصة):** "عذرًا، هذه المعلومة غير متوفرة لدي. للحصول على إجابة دقيقة، يُرجى التواصل مع الأستاذ الدكتور/ عصام علي على جروب الواتس اب الخاص بمبادرة 'اسأل واستشير قبل ما تدفع كتير'."
    *   **لأي أمور إدارية، معدات، أو استفسارات أخرى:** "عذرًا، هذه المعلومة غير متوفرة لدي. يمكنك التواصل مع الدكتور/ عماد عوض على جروب الواتس اب الخاص بالمبادرة لمزيد من التفاصيل."
5.  **خارج نطاق الزراعة:**
    *   إذا كان السؤال لا يتعلق بالزراعة إطلاقاً، أجب بوضوح: "عذراً، أنا متخصص فقط في الإجابة على الأسئلة المتعلقة بالزراعة بناءً على بيانات مركز بحوث الصحراء."
6.  **ممنوع الاختراع:**
    *   التزم بالمعلومات الموجودة في السياق المقدم لك فقط. لا تخترع أو تفترض أي معلومات غير موجودة.`;

const initializeChat = async (context) => {
    if (!ai) {
        throw new Error("AI client not initialized. API_KEY might be missing.");
    }
    const chat = ai.chats.create({
        model: 'gemini-2.5-flash',
        config: {
            systemInstruction: SYSTEM_INSTRUCTION,
            tools: [{ functionDeclarations: [ { name: "suggestedQuestions", description: "Generates a list of relevant follow-up questions to guide the user.", parameters: { type: Type.OBJECT, properties: { questions: { type: Type.ARRAY, description: "An array of 2-4 suggested question strings.", items: { type: Type.STRING } } }, required: ["questions"] } } ] }]
        },
        history: [
            { role: 'user', parts: [{ text: `هذا هو السياق الذي يجب أن تعتمد عليه في جميع إجاباتك: \n\n---CONTEXT START---\n${context}\n---CONTEXT END---` }] },
            { role: 'model', parts: [{ text: 'فهمت السياق. أنا الآن جاهز لتحويل المعلومات إلى محادثة تفاعلية وسأقترح أسئلة للمتابعة بعد كل إجابة.' }] }
        ]
    });
    return { chat };
};

const sendMessageStream = (chat, message) => {
    try {
        return chat.sendMessageStream({ message });
    } catch (error) {
        console.error("Error sending message to Gemini:", error);
        throw new Error("Failed to get response from AI service.");
    }
};

// --- From components/SuggestedQuestions.tsx ---
const SuggestedQuestions = ({ questions, onSelect }) => (
    <div className="flex flex-wrap gap-3 mt-4">
      {questions.map((q, i) => (
        <button key={i} onClick={() => onSelect(q)} className="px-4 py-2 chip text-base font-medium hover:bg-green-200 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-sm" aria-label={`اسأل: ${q}`}>
          {q}
        </button>
      ))}
    </div>
);

const InitialSuggestedQuestions = ({ questions, onSelect }) => (
    <div className="grid grid-cols-2 gap-2 mt-3 max-w-[20rem] sm:max-w-xs mx-auto p-2 rounded-xl bg-green-50 shadow-inner lemon-card">
      {questions.map((q, i) => (
        <button key={i} onClick={() => onSelect(q)} className="flex items-center justify-center text-center px-2 py-1 btn-primary rounded-md text-xs font-semibold shadow-md transform hover:scale-105 active:scale-95 focus:outline-none focus:ring-2 focus:ring-green-300" aria-label={`اسأل: ${q}`}>
          {q}
        </button>
      ))}
    </div>
);

// --- From components/ChatInterface.tsx ---
const MessageContent = ({ text, showWhatsAppLink, userQuestion, showTelegramLink, telegramAppendInfo }) => {
    const [isCopied, setIsCopied] = React.useState(false);

    const handleCopy = () => {
        if (!userQuestion) return;
        navigator.clipboard.writeText(userQuestion).then(() => {
            setIsCopied(true);
            setTimeout(() => setIsCopied(false), 2500);
        }).catch(err => {
            console.error('Failed to copy text: ', err);
        });
    };
    
    return (
        <div>
            {text.split('\n').map((line, index) => (
                <div key={index} className="whitespace-pre-wrap min-h-[1em]">
                    {line}
                </div>
            ))}
            {showWhatsAppLink && userQuestion && (
                <div className="mt-4 p-3 border-t border-slate-200">
                    <p className="text-sm font-bold text-slate-700 mb-3">للحصول على إجابة دقيقة، يرجى اتباع الخطوات التالية:</p>
                    <div className="space-y-3">
                        <div className="flex items-center gap-3">
                            <div className="flex-shrink-0 w-8 h-8 rounded-full bg-slate-200 text-slate-600 flex items-center justify-center font-bold text-lg">1</div>
                            <button 
                                onClick={handleCopy} 
                                className="inline-flex items-center justify-center gap-2 px-4 py-2 border border-slate-300 bg-white hover:bg-slate-50 text-slate-700 rounded-lg text-sm font-semibold shadow-sm w-full transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2"
                                aria-label="انسخ سؤالك"
                            >
                                <CopyIcon className="h-5 w-5" />
                                {isCopied ? '✓ تم نسخ السؤال' : 'انسخ سؤالك'}
                            </button>
                        </div>
                        <div className="flex items-center gap-3">
                            <div className="flex-shrink-0 w-8 h-8 rounded-full bg-slate-200 text-slate-600 flex items-center justify-center font-bold text-lg">2</div>
                            <a href={WHATSAPP_GROUP_URL} target="_blank" rel="noopener noreferrer" className="inline-flex items-center justify-center gap-2 px-4 py-2 btn-primary text-sm font-semibold shadow-lg transform hover:scale-105 active:scale-95 w-full">
                                <WhatsAppIcon className="h-5 w-5" />
                                انضم للجروب والصق السؤال
                            </a>
                        </div>
                    </div>
                </div>
            )}
            {showTelegramLink && telegramAppendInfo && (
                <div className="flex flex-col items-start mt-4 text-sm text-slate-600">
                    <p className="mb-2">
                        للمزيد من المعلومات يمكنك الاطلاع على {telegramAppendInfo.type} عن {telegramAppendInfo.name}، واليك رابط بوت التلجرام لمزيد من المعلومات.
                    </p>
                    <a href={TELEGRAM_BOT_URL} target="_blank" rel="noopener noreferrer" className="inline-flex items-center justify-center gap-2 px-4 py-2 btn-telegram btn-telegram-small text-white font-semibold shadow-lg transform hover:scale-105 active:scale-95 transition-all">
                        <TelegramIcon className="h-4 w-4" />
                        مراسلة بوت التلجرام
                    </a>
                </div>
            )}
        </div>
    );
};


const REDIRECTION_PHRASES_WHATSAPP = [
    "يُرجى التواصل مع الأستاذ الدكتور/ محمد رائف على جروب الواتس اب", "يُرجى التواصل مع الأستاذ الدكتور/ أحمد عماد على جروب الواتس اب", "يُرجى التواصل مع الأستاذ الدكتور/ محمد عبد الوهاب على جروب الواتس اب", "يُرجى التواصل مع الأستاذ الدكتور/ عصام علي على جروب الواتس اب", "يمكنك التواصل مع الدكتور/ عماد عوض على جروب الواتس اب"
];

const hasWhatsAppRedirectionPhrase = (text) => {
    return REDIRECTION_PHRASES_WHATSAPP.some(phrase => text.includes(phrase));
};

const INITIAL_HARDCODED_QUESTIONS = ["إحنا مين؟", "رؤيتنا؟", "رسالتنا؟", "ازاي اساعدك؟"];

// Hardcoded full answers for Olive Fertilization programs
const oliveFebMarchFertilizationFullAnswer = `برنامج التسميد الأرضي لشتلات الزيتون في فبراير ومارس:
*   منتصف فبراير: يضاف 2 لتر من معالج الملوحة لكل فدان.
*   الأسبوع الأول (فبراير): إضافة 3 لتر حامض نيتريك لكل فدان (عبر الري بالتنقيط).
*   الأسبوع الثاني (فبراير/مارس): يضاف 3 كجم نترات نشادر لكل فدان.
*   الأسبوع الثالث (مارس): يضاف 2 لتر حامض فوسفوريك لكل فدان.
*   الأسبوع الرابع (مارس): يضاف 3 كجم نترات نشادر لكل فدان.
ملاحظات: في حالة عدم توفر حامض النيتريك، يتم استخدام 3 كجم سماد 19/19/19 أو 20/20/20 بدلًا منه. في حالة عدم توفر نترات النشادر، يتم استخدام 3 كجم سماد 19/19/19 أو 20/20/20 بدلًا منه.
برنامج الرش الورقي لشتلات الزيتون في فبراير ومارس:
يتم رش العناصر الصغرى بمعدل 100 لتر لكل فدان، كالتالي:
*   75 جم زنك مخلبي
*   50 جم حديد مخلبي
*   75 جم بورون
*   50 جم موليبدنم
*   50 جم منجنيز
*   30 سم مادة ناشرة
يتم الرش في الصباح الباكر أو آخر النهار.`;
const oliveAprilFertilizationFullAnswer = `برنامج تسميد وري شتلات الزيتون في شهر أبريل:
برنامج التسميد:
*   الأسبوع الأول: يضاف 2 لتر من معالج الملوحة لكل فدان، ويتم إضافة 3 كجم نترات نشادر لكل فدان.
*   الأسبوع الثاني: يضاف 2 لتر حامض فوسفوريك لكل فدان، ويتم استخدام 3 كجم نترات نشادر لكل فدان.
*   الأسبوع الثالث: يضاف 3 لتر حامض نيتريك لكل فدان، ويتم استخدام 3 كجم نترات نشادر لكل فدان.
*   الأسبوع الرابع: يضاف 2 لتر حامض فوسفوريك لكل فدان، ويتم إضافة 3 لتر حامض نيتريك لكل فدان.
ملاحظة: في حالة عدم توفر نترات النشادر، يتم استخدام 5 كجم سماد 19/19/19 أو 20/20/20 بدلًا منه.
برنامج الري:
*   شتلات عمر سنة أو أكثر: 10 لتر ماء يوميًا أو 20 لتر يوم بعد يوم.
*   شتلات حديثة عمر ستة أشهر: 8 لتر ماء يوميًا أو 16 لتر يوم بعد يوم.`;
const oliveMayFertilizationFullAnswer = `برنامج تسميد وري شتلات الزيتون في شهر مايو:
برنامج التسميد:
*   الأسبوع الأول: مع الرية الأولى يضاف 2 لتر من معالج الملوحة لكل فدان. مع الرية الثانية إضافة 3 لتر حامض نيتريك لكل فدان.
*   الأسبوع الثاني: مع الرية الأولى يضاف 2 لتر حامض فوسفوريك لكل فدان. مع الرية الثانية إضافة 3 كجم سلفات بوتاسيوم لكل فدان.
*   الأسبوع الثالث: مع الرية الأولى يضاف 2 لتر من معالج الملوحة لكل فدان. مع الرية الثانية إضافة 3 لتر حامض نيتريك لكل فدان.
*   الأسبوع الرابع: مع الرية الأولى إضافة 4 كجم نترات نشادر لكل فدان. مع الرية الثانية إضافة 2 لتر حامض فوسفوريك لكل فدان.
ملاحظة: في حالة عدم توفر نترات النشادر، يتم استخدام 5 كجم سماد 19/19/19 أو 20/20/20 بدلًا منه.
برنامج الري: 12 لتر ماء يوميًا أو 24 لتر يوم بعد يوم.`;
const oliveJuneJulyFertilizationFullAnswer = `برنامج تسميد وري شتلات الزيتون في يونيو ويوليو:
برنامج التسميد:
*   الأسبوع الأول: مع الرية الأولى يضاف 2 لتر من معالج الملوحة لكل فدان. مع الرية الثانية يضاف 3 لتر حامض نيتريك لكل فدان. ملاحظة: في حالة عدم توفر حامض النيتريك يضاف 4 كجم نترات نشادر أو استخدام 5 كجم سماد 19/19/19 بدلًا منه.
*   الأسبوع الثاني: مع الرية الأولى يضاف 2 لتر حامض فوسفوريك لكل فدان. مع الرية الثانية يضاف 4 كجم نترات نشادر لكل فدان. ملاحظة: في حالة عدم توفر نترات النشادر يتم استخدام 5 كجم سماد 19/19/19 أو 20/20/20 بدلًا منه.
*   الأسبوع الثالث: مع الرية الأولى يضاف 2 لتر من معالج الملوحة لكل فدان. مع الرية الثانية يضاف 3 لتر حامض نيتريك لكل فدان.
*   الأسبوع الرابع: مع الرية الأولى يضاف 4 كجم نترات نشادر لكل فدان. مع الرية الثانية يضاف 2 لتر حامض فوسفوريك لكل فدان.
برنامج الري:
*   شتلات عمرها أقل من سنة: 12 لتر ماء يوميًا أو 24 لتر يوم بعد يوم.
*   شتلات عمرها أكبر من سنة: 16 لتر ماء يوميًا أو 32 لتر يوم بعد يوم.`;
const oliveAugustFertilizationFullAnswer = `برنامج تسميد وري شتلات الزيتون في شهر أغسطس:
برنامج التسميد:
*   الأسبوع الأول: يضاف 2 لتر من معالج الملوحة و3 كجم نترات نشادر لكل فدان.
*   الأسبوع الثاني: يضاف 2 لتر حامض فوسفوريك و5 كجم كبريتات بوتاسيوم لكل فدان.
*   الأسبوع الثالث: يضاف 2 لتر من معالج الملوحة و3 كجم نترات نشادر لكل فدان.
*   الأسبوع الرابع: يضاف 2 لتر حامض هيوميك لكل فدان، ويتم استخدام الرش الورقي.
الرش الورقي:
*   رش العناصر الصغرى: 100 لتر ماء لكل فدان، كالتالي:
    *   50 جم زنك مخلبي, 50 جم حديد مخلبي, 75 جم بورون, 50 جم موليبدنم, 50 جم منجنيز, 30 سم مادة ناشرة
    *   الرش في الصباح الباكر أو آخر النهار.
برنامج الري:
*   شتلات عمرها أقل من سنة: 12 لتر ماء يوميًا أو 24 لتر يوم بعد يوم.
*   شتلات عمرها أكبر من سنة: 16 لتر ماء يوميًا أو 32 لتر يوم بعد يوم.`;
const oliveSeptemberFertilizationFullAnswer = `برنامج تسميد وري شتلات الزيتون في شهر سبتمبر:
برنامج التسميد:
*   الأسبوع الأول: مع الرية الأولى يضاف 2 لتر معالج ملوحة، مع الرية الثانية 3 كجم نترات نشادر، ومع الرية الثالثة 2 كجم سلفات بوتاسيوم لكل فدان. (بديل نترات النشادر: 5 كجم سماد 19/19/19 أو 20/20/20).
*   الأسبوع الثاني: مع الرية الأولى 2 لتر حامض نيتريك، ومع الرية الثانية 5 كجم كمبوست سائل أو منقوع سبلة دواجن لكل فدان. الرية الثالثة بدون تسميد. (بديل حامض النيتريك: 5 كجم سماد 19/19/19 أو 20/20/20).
*   الأسبوع الثالث: مع الرية الأولى 3 كجم نترات نشادر، ومع الرية الثانية 2 لتر معالج ملوحة، ومع الرية الثالثة ضخ 2 لتر حامض فوسفوريك لكل فدان.
*   الأسبوع الرابع: مع الرية الأولى 3 كجم نترات نشادر، ومع الرية الثانية 5 كجم كمبوست سائل أو منقوع سبلة دواجن لكل فدان. الرية الثالثة ري غسيل فقط.
برنامج الري:
*   شتلات عمرها أقل من سنة: 12 لتر ماء يوميًا أو 24 لتر يوم بعد يوم.
*   شتلات عمرها أكبر من سنة: 20 لتر ماء يوميًا أو 40 لتر يوم بعد يوم.
*   يمنع الري من الساعة العاشرة صباحًا حتى السادسة مساءً.`;


const ChatInterface = ({ onReset }) => {
  const [messages, setMessages] = useState([]);
  const [input, setInput] = useState('');
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState(null);
  const [chat, setChat] = useState(null);
  // NEW: State to track remaining initial questions
  const [remainingInitialQuestions, setRemainingInitialQuestions] = useState([...INITIAL_HARDCODED_QUESTIONS]);
  
  const messagesEndRef = useRef(null);
  const textareaRef = useRef(null);

  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  };
  
  const setupChat = useCallback(async (userContext) => {
    if (!ai) {
        setError('لم يتم تعيين مفتاح API. يرجى تهيئة بيئة التشغيل.');
        setIsLoading(false);
        return;
    }
    setIsLoading(true);
    setError(null);
    try {
      const { chat: newChat } = await initializeChat(userContext);
      setChat(newChat);
      
      const botMessagePlaceholderId = 'initial-bot-message';
      
      // MODIFIED: Shortened welcome message
      const welcomeMessageText = `💬 اسأل سؤالك مباشرة أو اختار موضوع تبدأ منه:`;

      setMessages([{
        id: botMessagePlaceholderId,
        sender: Sender.Bot,
        text: welcomeMessageText,
        suggestedQuestions: INITIAL_HARDCODED_QUESTIONS,
        isInitialMessage: true,
        showWhatsAppLink: false,
        userQuestion: null,
        showTelegramLink: false,
        telegramAppendInfo: null
      }]);
      setIsLoading(false); 

    } catch (e) {
      console.error(e);
      setError('حدث خطأ أثناء تهيئة المحادثة. تأكد من صحة مفتاح API الخاص بك وأعد تحميل الصفحة.');
      setMessages([]);
    } finally {
      setIsLoading(false);
    }
  }, []);


  useEffect(() => {
    setupChat(agricultureContextCombined); 
  }, [setupChat]);

  useEffect(() => {
    scrollToBottom();
  }, [messages]);
  
  useEffect(() => {
    if (textareaRef.current) {
        textareaRef.current.style.height = 'auto';
        textareaRef.current.style.height = `${textareaRef.current.scrollHeight}px`;
    }
  }, [input]);

  const handleSendMessage = async (messageText) => {
    const currentInput = messageText || input;
    if (currentInput.trim() === '' || !chat) return;

    setMessages(prev => prev.map(msg => ({ ...msg, suggestedQuestions: [] })));

    const userMessage = {
      id: `user-${Date.now()}`,
      sender: Sender.User,
      text: currentInput,
    };
    setMessages(prev => [...prev, userMessage]);
    
    if (!messageText) {
      setInput('');
    }
    
    let botResponseText = '';
    let botSuggestedQuestions = [];
    let isHardcodedResponse = false;
    let suppressFurtherSuggestions = false;
    let showWhatsAppLink = false;
    let telegramAppendInfoForBot = null;

    const lowerCaseInput = currentInput.toLowerCase();
    const detectedTelegramTopic = getTelegramRedirectionInfo(currentInput);
    if (detectedTelegramTopic) {
        telegramAppendInfoForBot = detectedTelegramTopic;
    }
    
    // NEW: Logic for dynamic initial questions
    const isInitialQuestion = INITIAL_HARDCODED_QUESTIONS.includes(currentInput);
    let updatedRemainingQuestions = remainingInitialQuestions;
    if(isInitialQuestion) {
        updatedRemainingQuestions = remainingInitialQuestions.filter(q => q !== currentInput);
        setRemainingInitialQuestions(updatedRemainingQuestions);
    }

    if (PEST_CONTROL_KEYWORDS.some(keyword => lowerCaseInput.includes(keyword))) {
        isHardcodedResponse = true;
        botResponseText = "عذرًا، هذه المعلومة غير متوفرة لدي. للحصول على إجابة دقيقة، يُرجى التواصل مع الأستاذ الدكتور/ عصام علي على جروب الواتس اب الخاص بمبادرة 'اسأل واستشير قبل ما تدفع كتير'.";
        showWhatsAppLink = true;
        botSuggestedQuestions = [];
        suppressFurtherSuggestions = true;
        telegramAppendInfoForBot = null;
    } else if (lowerCaseInput.includes("برنامج تسميد وري شتلات الزيتون في فبراير ومارس") || lowerCaseInput.includes("برنامج تسميد وري الزيتون في فبراير ومارس")) {
        isHardcodedResponse = true; botResponseText = oliveFebMarchFertilizationFullAnswer; botSuggestedQuestions = ["ما هو برنامج تسميد وري شتلات الزيتون في شهر أبريل؟", "كيف أحمي شتلات الزيتون قبل الزراعة؟"];
    } else if (lowerCaseInput.includes("برنامج تسميد وري شتلات الزيتون في شهر أبريل") || lowerCaseInput.includes("برنامج تسميد وري الزيتون لشهر أبريل")) {
        isHardcodedResponse = true; botResponseText = oliveAprilFertilizationFullAnswer; botSuggestedQuestions = ["ما هو برنامج تسميد وري شتلات الزيتون في شهر مايو؟", "كمية الري لشتلات الزيتون في أبريل؟"];
    } else if (lowerCaseInput.includes("برنامج تسميد وري شتلات الزيتون في شهر مايو") || lowerCaseInput.includes("برنامج تسميد وري الزيتون لشهر مايو")) {
        isHardcodedResponse = true; botResponseText = oliveMayFertilizationFullAnswer; botSuggestedQuestions = ["ما هي كمية الري لشتلات الزيتون في مايو؟", "ما هو برنامج تسميد وري شتلات الزيتون في يونيو ويوليو؟"];
    } else if (lowerCaseInput.includes("برنامج تسميد وري شتلات الزيتون في يونيو ويوليو") || lowerCaseInput.includes("برنامج تسميد وري الزيتون لشهر يونيو ويوليو") || lowerCaseInput.includes("برنامج تسميد وري شتلات الزيتون في يوليو") || lowerCaseInput.includes("برنامج تسميد وري الزيتون لشهر يوليو")) {
        isHardcodedResponse = true; botResponseText = oliveJuneJulyFertilizationFullAnswer; botSuggestedQuestions = ["كمية الري لشتلات الزيتون في يونيو ويوليو حسب العمر؟", "ما هو برنامج تسميد وري شتلات الزيتون في شهر أغسطس؟"];
    } else if (lowerCaseInput.includes("برنامج تسميد وري شتلات الزيتون في شهر أغسطس") || lowerCaseInput.includes("برنامج تسميد وري الزيتون لشهر أغسطس")) {
        isHardcodedResponse = true; botResponseText = oliveAugustFertilizationFullAnswer; botSuggestedQuestions = ["تفاصيل الرش الورقي لشتلات الزيتون في أغسطس؟", "كمية الري لشتلات الزيتون في أغسطس حسب العمر؟", "ما هو برنامج تسميد وري شتلات الزيتون في شهر سبتمبر؟"];
    } else if (lowerCaseInput.includes("برنامج تسميد وري شتلات الزيتون في شهر سبتمبر") || lowerCaseInput.includes("برنامج تسميد وري الزيتون لشهر سبتمبر")) {
        isHardcodedResponse = true; botResponseText = oliveSeptemberFertilizationFullAnswer; botSuggestedQuestions = ["كمية الري لشتلات الزيتون في سبتمبر حسب العمر؟", "ما هو بديل نترات النشادر في تسميد سبتمبر؟"];
    } else if (currentInput === "إحنا مين؟" || currentInput === "من نحن؟") {
        isHardcodedResponse = true;
        botResponseText = "مبادرة أطلقها مركز بحوث الصحراء لدعم مزارعي التجمعات الزراعية في سيناء من خلال استشارات فنية مجانية عبر الزيارات الميدانية أو الوسائل الإلكترونية على مدار.";
        botSuggestedQuestions = updatedRemainingQuestions; // Use the dynamic list
    } else if (currentInput === "رؤيتنا؟" || currentInput === "ما هي رؤيتنا؟") {
        isHardcodedResponse = true;
        botResponseText = "أن نكون المصدر الأول للمشورة الزراعية العلمية والمباشرة للمزارعين في سيناء، من خلال تقديم إرشادات مهنية وفنية تساهم في رفع الإنتاجية الزراعية وتحقيق التنمية المستدامة، مما يسهم في تحسين حياة المزارعين وتوفر مواردهم بشكل أكثر فعالية.";
        botSuggestedQuestions = updatedRemainingQuestions; // Use the dynamic list
    } else if (currentInput === "رسالتنا؟" || currentInput === "ما هي رسالتنا؟") {
        isHardcodedResponse = true;
        botResponseText = "تقديم استشارات زراعية علمية ومجانية للمزارعين في سيناء، لمساعدتهم في اتخاذ قرارات زراعية مستنيرة تؤدي إلى تحسين جودة المحاصيل وزيادة الإنتاجية، لدعم على توفير الدعم الفني المتواصل سواء من خلال الزيارات الميدانية أو عبر القنوات الإلكترونية، بهدف ترشيد النفقات وتفادي الأخطاء المكلفة.";
        botSuggestedQuestions = updatedRemainingQuestions; // Use the dynamic list
    } else if (currentInput === "ازاي اساعدك؟" || currentInput === "كيف يمكنني الحصول على استشارة زراعية؟") {
        isHardcodedResponse = true;
        botResponseText = "يمكنك طرح سؤالك مباشرة، أو اختيار أحد المواضيع المقترحة، أو التواصل مع الخبراء مباشرة عبر جروب الواتس اب للمبادرة إذا كانت المعلومات غير متوفرة هنا. نحن نوفر دعم فني متواصل عبر الزيارات الميدانية أو القنوات الإلكترونية.";
        botSuggestedQuestions = updatedRemainingQuestions; // Use the dynamic list
        if (updatedRemainingQuestions.length === 0) suppressFurtherSuggestions = true;
    }

    if (isHardcodedResponse) {
      const finalBotMessage = {
          id: `bot-${Date.now()}`, sender: Sender.Bot, text: botResponseText, suggestedQuestions: suppressFurtherSuggestions ? [] : botSuggestedQuestions, showWhatsAppLink: showWhatsAppLink, userQuestion: showWhatsAppLink ? currentInput : null, showTelegramLink: !!telegramAppendInfoForBot, telegramAppendInfo: telegramAppendInfoForBot
      };
      setMessages(prevMessages => [...prevMessages, finalBotMessage]);
    } else {
      setIsLoading(true);
      setError(null);
      const botMessagePlaceholderId = `bot-${Date.now()}`;
      setMessages(prev => [...prev, { id: botMessagePlaceholderId, sender: Sender.Bot, text: '', showWhatsAppLink: false, userQuestion: null, showTelegramLink: false, telegramAppendInfo: null }]);

      try {
        const stream = await sendMessageStream(chat, currentInput);
        let fullResponseText = '';
        let suggestions = undefined;
        let aiGeneratedShowWhatsAppLink = false;
        
        for await (const chunk of stream) {
            const parts = chunk.candidates?.[0]?.content?.parts ?? [];
            for(const part of parts) {
                if (part.text) {
                    fullResponseText += part.text;
                    if (!aiGeneratedShowWhatsAppLink && hasWhatsAppRedirectionPhrase(fullResponseText)) {
                        aiGeneratedShowWhatsAppLink = true;
                    }
                } else if (part.functionCall?.name === 'suggestedQuestions' && Array.isArray(part.functionCall.args?.questions)) {
                    suggestions = part.functionCall.args.questions;
                }
            }
            
            const currentMessage = {
                id: botMessagePlaceholderId, sender: Sender.Bot, text: fullResponseText, suggestedQuestions: suggestions, showWhatsAppLink: aiGeneratedShowWhatsAppLink, userQuestion: aiGeneratedShowWhatsAppLink ? currentInput : null, showTelegramLink: false, telegramAppendInfo: null
            };
            setMessages(prevMessages => prevMessages.map(msg => msg.id === botMessagePlaceholderId ? currentMessage : msg));
        }
        setMessages(prevMessages => 
            prevMessages.map(msg => {
                if (msg.id === botMessagePlaceholderId) {
                    return { ...msg, showTelegramLink: !!telegramAppendInfoForBot, telegramAppendInfo: telegramAppendInfoForBot };
                }
                return msg;
            })
        );
      } catch (e) {
        console.error(e);
        setError('حدث خطأ أثناء إرسال الرسالة. يرجى المحاولة مرة أخرى.');
        setMessages(prev => prev.filter(msg => msg.id !== botMessagePlaceholderId));
      } finally {
        setIsLoading(false);
      }
    }
  };

  const handleKeyDown = (event) => {
    if (event.key === 'Enter' && !event.shiftKey) {
      event.preventDefault();
      handleSendMessage();
    }
  };
  
  const handleInput = (e) => {
    setInput(e.target.value);
  };

  const handleSelectQuestion = (question) => {
    handleSendMessage(question);
  };

  if (isLoading && messages.length === 0) {
    return (
        <div className="flex flex-col items-center justify-center flex-grow w-full max-w-6xl lemon-card p-8">
            <div className="flex items-center justify-center space-x-2 rtl:space-x-reverse" dir="ltr">
                <div className="h-4 w-4 bg-[var(--drc-green)] rounded-full animate-bounce [animation-delay:-0.3s]"></div>
                <div className="h-4 w-4 bg-[var(--drc-green)] rounded-full animate-bounce [animation-delay:-0.15s]"></div>
                <div className="h-4 w-4 bg-[var(--drc-green)] rounded-full animate-bounce"></div>
            </div>
            <p className="mt-4 text-lg text-slate-600">...جاري تهيئة المساعد الذكي</p>
        </div>
    );
  }

  return (
    <div className="flex flex-col flex-grow w-full max-w-6xl lemon-card overflow-hidden">
       {/* MODIFIED: Chat Interface Header */}
       <div className="flex items-center p-3 border-b border-soft flex-shrink-0 bg-paper">
        <div className="w-12 h-12 ml-3 rtl:mr-3 flex-shrink-0">
            <ChatHeaderLogo />
        </div>
        <div className="flex flex-col items-start leading-tight">
            <h1 className="text-lg font-bold text-ink tracking-wide">
              مساعدك الذكي في تجمعك التنموي
            </h1>
            <p className="text-sm font-medium text-slate-600">
              مرحباً بك <span role="img" aria-label="wave">👋</span> أنا مساعدك الذكي
            </p>
        </div>
      </div>
      <div className="flex-grow p-6 overflow-y-auto">
        {messages.map((message) => (
          <div key={message.id} className="chat-message my-4">
            <div className={`flex items-start gap-3 ${message.sender === Sender.User ? 'flex-row-reverse' : 'flex-row'}`}>
                <div className={`w-10 h-10 rounded-full text-white flex items-center justify-center flex-shrink-0 p-1.5 shadow-md ${message.sender === Sender.Bot ? 'bg-gradient-to-br from-drc-green to-drc-blue' : 'bg-gradient-to-br from-slate-500 to-slate-600'}`}>
                {message.sender === Sender.Bot ? <BotIcon /> : <UserIcon />}
                </div>
                <div className={`px-5 py-3.5 rounded-2xl max-w-3xl break-words shadow-md ${message.sender === Sender.User ? 'bubble-user rounded-br-none' : 'bubble-bot rounded-bl-none'}`}>
                {message.text === '' && message.sender === Sender.Bot && isLoading ? (
                    <div className="flex items-center space-x-1.5 rtl:space-x-reverse py-1" dir="ltr">
                        <span className="sr-only">Loading...</span>
                        <div className="h-2 w-2 bg-drc-green rounded-full animate-bounce [animation-delay:-0.3s]"></div>
                        <div className="h-2 w-2 bg-drc-green rounded-full animate-bounce [animation-delay:-0.15s]"></div>
                        <div className="h-2 w-2 bg-drc-green rounded-full animate-bounce"></div>
                    </div>
                ) : (
                    <MessageContent 
                      text={message.text || ''} 
                      showWhatsAppLink={message.showWhatsAppLink} 
                      userQuestion={message.userQuestion}
                      showTelegramLink={message.showTelegramLink} 
                      telegramAppendInfo={message.telegramAppendInfo} 
                    />
                )}
                </div>
            </div>
            {message.sender === Sender.Bot && message.suggestedQuestions && message.suggestedQuestions.length > 0 && (
                <div className="pl-14 rtl:pr-14 rtl:pl-0 pt-3 max-w-3xl">
                    {message.isInitialMessage ? (
                        <InitialSuggestedQuestions questions={message.suggestedQuestions} onSelect={handleSelectQuestion} />
                    ) : (
                        <SuggestedQuestions questions={message.suggestedQuestions} onSelect={handleSelectQuestion} />
                    )}
                </div>
            )}
          </div>
        ))}
        {error && (
           <div className={`p-4 text-center text-red-600 bg-red-100 rounded-lg ${messages.length === 0 ? '' : 'mt-4'}`}>
             {error}
           </div>
        )}
        <div ref={messagesEndRef} />
      </div>

      <div className="p-4 bg-white/50 border-t border-soft flex-shrink-0">
        <div className="flex items-end gap-2 input-shell p-2 has-[:focus-within]:ring-2 has-[:focus-within]:ring-green-500 transition-all">
          <button onClick={onReset} className="flex items-center gap-2 px-3 py-2 rounded-xl bg-soft text-slate-700 disabled:bg-slate-300 disabled:cursor-not-allowed hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-paper focus:ring-green-500 transition-colors flex-shrink-0 shadow-sm font-semibold" title="بدء دردشة جديدة" aria-label="بدء دردشة جديدة">
              <NewChatIcon />
              <span className="hidden sm:inline">دردشة جديدة</span>
          </button>
          <textarea ref={textareaRef} className="flex-grow p-2 bg-transparent focus:outline-none resize-none max-h-40 text-ink placeholder:text-slate-500" placeholder={isLoading ? "يرجى الانتظار..." : "اكتب رسالتك هنا..."} value={input} onChange={handleInput} onKeyDown={handleKeyDown} rows={1} disabled={isLoading || chat === null} aria-label="Chat input" />
          <button onClick={() => handleSendMessage()} disabled={isLoading || !input.trim() || chat === null} className="p-3 rounded-xl btn-primary disabled:bg-slate-400 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-paper focus:ring-green-500 transition-colors flex-shrink-0 shadow-md" aria-label="Send message">
            <SendIcon />
          </button>
        </div>
      </div>
    </div>
  );
};

const Header = () => (
    <header className="sticky top-0 z-20 lemon-header shadow-lg w-full">
      <div className="container mx-auto flex justify-start items-center gap-4 py-3 px-3">
        <div className="w-12 h-12 p-0 bg-transparent rounded-none shadow-md">
           <DesertResearchCenterLogo />
        </div>
        <div className="flex flex-col items-start leading-none">
          <h1 className="text-lg md:text-xl font-bold text-white tracking-wide leading-tight">
            مبادرة اسأل واستشير قبل ما تدفع كتير
          </h1>
          <p className="text-xs md:text-sm font-medium text-green-200 leading-tight">
            مقدمة من مركز بحوث الصحراء
            <span className="inline-block text-xs font-normal text-green-200 mr-1 rtl:ml-1 whitespace-nowrap experience-animation-text">
                (٧٥ عامًا من الخبرة)
            </span>
          </p>
        </div>
      </div>
    </header>
);

const App = () => {
  const [chatKey, setChatKey] = useState(0);
  const handleReset = () => {
    setChatKey(prevKey => prevKey + 1);
  };

  return (
    <div className="min-h-screen flex flex-col text-ink relative">
      <div className="lemon-decor"></div>
      <Header />
      <main className="flex-grow flex flex-col items-center p-2 md:p-4 w-full relative z-10">
        <ChatInterface key={chatKey} onReset={handleReset} />
        <footer className="mt-4 mb-2 text-center text-slate-500 relative z-10 px-2">
          <div className="flex items-start justify-center gap-2 text-xs text-slate-700 mb-2 bg-yellow-50 border border-yellow-200 rounded-lg p-2 max-w-md mx-auto">
              <InfoIcon className="h-5 w-5 text-yellow-500 flex-shrink-0 mt-0.5" />
              <span className="text-right">
                  <strong>تنويه:</strong> هذا تطبيق تجريبي، والمعلومات للاسترشاد فقط ووارد حدوث أخطاء. للاستشارة الدقيقة، تواصل مع خبراء المبادرة.
              </span>
          </div>
          <p className="text-xs font-semibold text-green-700">تم التصميم بواسطة</p>
          <p className="text-xs">أعضاء الفريق البحثي لمبادرة اسأل واستشير قبل ما تدفع كتير</p>
          <p className="text-xs mt-1">© {new Date().getFullYear()} حقوق النشر محفوظة لمركز بحوث الصحراء</p>
        </footer>
      </main>
    </div>
  );
};

const rootElement = document.getElementById('root');
if (!rootElement) {
  throw new Error("Could not find root element to mount to");
}

const root = ReactDOM.createRoot(rootElement);
root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);

// --- End of consolidated application code ---
    </script>
  </body>
</html>
```